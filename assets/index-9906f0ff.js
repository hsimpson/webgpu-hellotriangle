(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(t){if(t.ep)return;t.ep=!0;const i=o(t);fetch(t.href,i)}})();let q=1e-6;const Sn=new Map([[Float32Array,()=>new Float32Array(12)],[Float64Array,()=>new Float64Array(12)],[Array,()=>new Array(12).fill(0)]]);Sn.get(Float32Array);let g=Float32Array;function vn(e){const n=g;return g=e,n}function I(e,n,o){const r=new g(3);return e!==void 0&&(r[0]=e,n!==void 0&&(r[1]=n,o!==void 0&&(r[2]=o))),r}const Tn=I;function Bn(e,n){return n=n||new g(3),n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n}function Pn(e,n){return n=n||new g(3),n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n}function qn(e,n){return n=n||new g(3),n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n}function En(e,n=0,o=1,r){return r=r||new g(3),r[0]=Math.min(o,Math.max(n,e[0])),r[1]=Math.min(o,Math.max(n,e[1])),r[2]=Math.min(o,Math.max(n,e[2])),r}function Cn(e,n,o){return o=o||new g(3),o[0]=e[0]+n[0],o[1]=e[1]+n[1],o[2]=e[2]+n[2],o}function On(e,n,o,r){return r=r||new g(3),r[0]=e[0]+n[0]*o,r[1]=e[1]+n[1]*o,r[2]=e[2]+n[2]*o,r}function Un(e,n){const o=e[0],r=e[1],t=e[2],i=e[0],c=e[1],h=e[2],l=Math.sqrt(o*o+r*r+t*t),p=Math.sqrt(i*i+c*c+h*h),f=l*p,a=f&&hn(e,n)/f;return Math.acos(a)}function b(e,n,o){return o=o||new g(3),o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],o}const Vn=b;function Fn(e,n){return Math.abs(e[0]-n[0])<q&&Math.abs(e[1]-n[1])<q&&Math.abs(e[2]-n[2])<q}function Ln(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function mn(e,n,o,r){return r=r||new g(3),r[0]=e[0]+o*(n[0]-e[0]),r[1]=e[1]+o*(n[1]-e[1]),r[2]=e[2]+o*(n[2]-e[2]),r}function Gn(e,n,o,r){return r=r||new g(3),r[0]=e[0]+o[0]*(n[0]-e[0]),r[1]=e[1]+o[1]*(n[1]-e[1]),r[2]=e[2]+o[2]*(n[2]-e[2]),r}function Rn(e,n,o){return o=o||new g(3),o[0]=Math.max(e[0],n[0]),o[1]=Math.max(e[1],n[1]),o[2]=Math.max(e[2],n[2]),o}function Nn(e,n,o){return o=o||new g(3),o[0]=Math.min(e[0],n[0]),o[1]=Math.min(e[1],n[1]),o[2]=Math.min(e[2],n[2]),o}function an(e,n,o){return o=o||new g(3),o[0]=e[0]*n,o[1]=e[1]*n,o[2]=e[2]*n,o}const Dn=an;function In(e,n,o){return o=o||new g(3),o[0]=e[0]/n,o[1]=e[1]/n,o[2]=e[2]/n,o}function un(e,n){return n=n||new g(3),n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}const _n=un;function Y(e,n,o){o=o||new g(3);const r=e[2]*n[0]-e[0]*n[2],t=e[0]*n[1]-e[1]*n[0];return o[0]=e[1]*n[2]-e[2]*n[1],o[1]=r,o[2]=t,o}function hn(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function fn(e){const n=e[0],o=e[1],r=e[2];return Math.sqrt(n*n+o*o+r*r)}const Xn=fn;function ln(e){const n=e[0],o=e[1],r=e[2];return n*n+o*o+r*r}const Wn=ln;function pn(e,n){const o=e[0]-n[0],r=e[1]-n[1],t=e[2]-n[2];return Math.sqrt(o*o+r*r+t*t)}const Yn=pn;function sn(e,n){const o=e[0]-n[0],r=e[1]-n[1],t=e[2]-n[2];return o*o+r*r+t*t}const Zn=sn;function W(e,n){n=n||new g(3);const o=e[0],r=e[1],t=e[2],i=Math.sqrt(o*o+r*r+t*t);return i>1e-5?(n[0]=o/i,n[1]=r/i,n[2]=t/i):(n[0]=0,n[1]=0,n[2]=0),n}function bn(e,n){return n=n||new g(3),n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function Mn(e,n){return n=n||new g(3),n[0]=e[0],n[1]=e[1],n[2]=e[2],n}const jn=Mn;function wn(e,n,o){return o=o||new g(3),o[0]=e[0]*n[0],o[1]=e[1]*n[1],o[2]=e[2]*n[2],o}const Hn=wn;function yn(e,n,o){return o=o||new g(3),o[0]=e[0]/n[0],o[1]=e[1]/n[1],o[2]=e[2]/n[2],o}const Qn=yn;function Kn(e=1,n){n=n||new g(3);const o=Math.random()*2*Math.PI,r=Math.random()*2-1,t=Math.sqrt(1-r*r)*e;return n[0]=Math.cos(o)*t,n[1]=Math.sin(o)*t,n[2]=r*e,n}function Jn(e){return e=e||new g(3),e[0]=0,e[1]=0,e[2]=0,e}function kn(e,n,o){o=o||new g(3);const r=e[0],t=e[1],i=e[2],c=n[3]*r+n[7]*t+n[11]*i+n[15]||1;return o[0]=(n[0]*r+n[4]*t+n[8]*i+n[12])/c,o[1]=(n[1]*r+n[5]*t+n[9]*i+n[13])/c,o[2]=(n[2]*r+n[6]*t+n[10]*i+n[14])/c,o}function dn(e,n,o){o=o||new g(3);const r=e[0],t=e[1],i=e[2];return o[0]=r*n[0*4+0]+t*n[1*4+0]+i*n[2*4+0],o[1]=r*n[0*4+1]+t*n[1*4+1]+i*n[2*4+1],o[2]=r*n[0*4+2]+t*n[1*4+2]+i*n[2*4+2],o}function ne(e,n,o){o=o||new g(3);const r=e[0],t=e[1],i=e[2];return o[0]=r*n[0]+t*n[4]+i*n[8],o[1]=r*n[1]+t*n[5]+i*n[9],o[2]=r*n[2]+t*n[6]+i*n[10],o}function ee(e,n){return n=n||new g(3),n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function oe(e,n,o){o=o||new g(3);const r=n*4;return o[0]=e[r+0],o[1]=e[r+1],o[2]=e[r+2],o}function re(e,n){n=n||new g(3);const o=e[0],r=e[1],t=e[2],i=e[4],c=e[5],h=e[6],l=e[8],p=e[9],f=e[10];return n[0]=Math.sqrt(o*o+r*r+t*t),n[1]=Math.sqrt(i*i+c*c+h*h),n[2]=Math.sqrt(l*l+p*p+f*f),n}var nn=Object.freeze({__proto__:null,create:I,setDefaultType:vn,fromValues:Tn,ceil:Bn,floor:Pn,round:qn,clamp:En,add:Cn,addScaled:On,angle:Un,subtract:b,sub:Vn,equalsApproximately:Fn,equals:Ln,lerp:mn,lerpV:Gn,max:Rn,min:Nn,mulScalar:an,scale:Dn,divScalar:In,inverse:un,invert:_n,cross:Y,dot:hn,length:fn,len:Xn,lengthSq:ln,lenSq:Wn,distance:pn,dist:Yn,distanceSq:sn,distSq:Zn,normalize:W,negate:bn,copy:Mn,clone:jn,multiply:wn,mul:Hn,divide:yn,div:Qn,random:Kn,zero:Jn,transformMat4:kn,transformMat4Upper3x3:dn,transformMat3:ne,getTranslation:ee,getAxis:oe,getScaling:re});let A=Float32Array;function te(e){const n=A;return A=e,n}function ce(e,n,o,r,t,i,c,h,l,p,f,a,u,w,M,y){const s=new A(16);return e!==void 0&&(s[0]=e,n!==void 0&&(s[1]=n,o!==void 0&&(s[2]=o,r!==void 0&&(s[3]=r,t!==void 0&&(s[4]=t,i!==void 0&&(s[5]=i,c!==void 0&&(s[6]=c,h!==void 0&&(s[7]=h,l!==void 0&&(s[8]=l,p!==void 0&&(s[9]=p,f!==void 0&&(s[10]=f,a!==void 0&&(s[11]=a,u!==void 0&&(s[12]=u,w!==void 0&&(s[13]=w,M!==void 0&&(s[14]=M,y!==void 0&&(s[15]=y)))))))))))))))),s}function ie(e,n){return n=n||new A(16),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=0,n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ae(e,n){n=n||new A(16);const o=e[0],r=e[1],t=e[2],i=e[3],c=o+o,h=r+r,l=t+t,p=o*c,f=r*c,a=r*h,u=t*c,w=t*h,M=t*l,y=i*c,s=i*h,z=i*l;return n[0]=1-a-M,n[1]=f+z,n[2]=u-s,n[3]=0,n[4]=f-z,n[5]=1-p-M,n[6]=w+y,n[7]=0,n[8]=u+s,n[9]=w-y,n[10]=1-p-a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ue(e,n){return n=n||new A(16),n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=-e[3],n[4]=-e[4],n[5]=-e[5],n[6]=-e[6],n[7]=-e[7],n[8]=-e[8],n[9]=-e[9],n[10]=-e[10],n[11]=-e[11],n[12]=-e[12],n[13]=-e[13],n[14]=-e[14],n[15]=-e[15],n}function en(e,n){return n=n||new A(16),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}const he=en;function fe(e,n){return Math.abs(e[0]-n[0])<q&&Math.abs(e[1]-n[1])<q&&Math.abs(e[2]-n[2])<q&&Math.abs(e[3]-n[3])<q&&Math.abs(e[4]-n[4])<q&&Math.abs(e[5]-n[5])<q&&Math.abs(e[6]-n[6])<q&&Math.abs(e[7]-n[7])<q&&Math.abs(e[8]-n[8])<q&&Math.abs(e[9]-n[9])<q&&Math.abs(e[10]-n[10])<q&&Math.abs(e[11]-n[11])<q&&Math.abs(e[12]-n[12])<q&&Math.abs(e[13]-n[13])<q&&Math.abs(e[14]-n[14])<q&&Math.abs(e[15]-n[15])<q}function le(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]&&e[9]===n[9]&&e[10]===n[10]&&e[11]===n[11]&&e[12]===n[12]&&e[13]===n[13]&&e[14]===n[14]&&e[15]===n[15]}function xn(e){return e=e||new A(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pe(e,n){if(n=n||new A(16),n===e){let x;return x=e[1],e[1]=e[4],e[4]=x,x=e[2],e[2]=e[8],e[8]=x,x=e[3],e[3]=e[12],e[12]=x,x=e[6],e[6]=e[9],e[9]=x,x=e[7],e[7]=e[13],e[13]=x,x=e[11],e[11]=e[14],e[14]=x,n}const o=e[0*4+0],r=e[0*4+1],t=e[0*4+2],i=e[0*4+3],c=e[1*4+0],h=e[1*4+1],l=e[1*4+2],p=e[1*4+3],f=e[2*4+0],a=e[2*4+1],u=e[2*4+2],w=e[2*4+3],M=e[3*4+0],y=e[3*4+1],s=e[3*4+2],z=e[3*4+3];return n[0]=o,n[1]=c,n[2]=f,n[3]=M,n[4]=r,n[5]=h,n[6]=a,n[7]=y,n[8]=t,n[9]=l,n[10]=u,n[11]=s,n[12]=i,n[13]=p,n[14]=w,n[15]=z,n}function gn(e,n){n=n||new A(16);const o=e[0*4+0],r=e[0*4+1],t=e[0*4+2],i=e[0*4+3],c=e[1*4+0],h=e[1*4+1],l=e[1*4+2],p=e[1*4+3],f=e[2*4+0],a=e[2*4+1],u=e[2*4+2],w=e[2*4+3],M=e[3*4+0],y=e[3*4+1],s=e[3*4+2],z=e[3*4+3],x=u*z,T=s*w,B=l*z,P=s*p,E=l*w,C=u*p,O=t*z,U=s*i,V=t*w,F=u*i,L=t*p,G=l*i,R=f*y,N=M*a,D=c*y,_=M*h,X=c*a,j=f*h,H=o*y,Q=M*r,K=o*a,J=f*r,k=o*h,d=c*r,on=x*h+P*a+E*y-(T*h+B*a+C*y),rn=T*r+O*a+F*y-(x*r+U*a+V*y),tn=B*r+U*h+L*y-(P*r+O*h+G*y),cn=C*r+V*h+G*a-(E*r+F*h+L*a),m=1/(o*on+c*rn+f*tn+M*cn);return n[0]=m*on,n[1]=m*rn,n[2]=m*tn,n[3]=m*cn,n[4]=m*(T*c+B*f+C*M-(x*c+P*f+E*M)),n[5]=m*(x*o+U*f+V*M-(T*o+O*f+F*M)),n[6]=m*(P*o+O*c+G*M-(B*o+U*c+L*M)),n[7]=m*(E*o+F*c+L*f-(C*o+V*c+G*f)),n[8]=m*(R*p+_*w+X*z-(N*p+D*w+j*z)),n[9]=m*(N*i+H*w+J*z-(R*i+Q*w+K*z)),n[10]=m*(D*i+Q*p+k*z-(_*i+H*p+d*z)),n[11]=m*(j*i+K*p+d*w-(X*i+J*p+k*w)),n[12]=m*(D*u+j*s+N*l-(X*s+R*l+_*u)),n[13]=m*(K*s+R*t+Q*u-(H*u+J*s+N*t)),n[14]=m*(H*l+d*s+_*t-(k*s+D*t+Q*l)),n[15]=m*(k*u+X*t+J*l-(K*l+d*u+j*t)),n}function se(e){const n=e[0],o=e[0*4+1],r=e[0*4+2],t=e[0*4+3],i=e[1*4+0],c=e[1*4+1],h=e[1*4+2],l=e[1*4+3],p=e[2*4+0],f=e[2*4+1],a=e[2*4+2],u=e[2*4+3],w=e[3*4+0],M=e[3*4+1],y=e[3*4+2],s=e[3*4+3],z=a*s,x=y*u,T=h*s,B=y*l,P=h*u,E=a*l,C=r*s,O=y*t,U=r*u,V=a*t,F=r*l,L=h*t,G=z*c+B*f+P*M-(x*c+T*f+E*M),R=x*o+C*f+V*M-(z*o+O*f+U*M),N=T*o+O*c+F*M-(B*o+C*c+L*M),D=E*o+U*c+L*f-(P*o+V*c+F*f);return n*G+i*R+p*N+w*D}const Me=gn;function zn(e,n,o){o=o||new A(16);const r=e[0],t=e[1],i=e[2],c=e[3],h=e[4+0],l=e[4+1],p=e[4+2],f=e[4+3],a=e[8+0],u=e[8+1],w=e[8+2],M=e[8+3],y=e[12+0],s=e[12+1],z=e[12+2],x=e[12+3],T=n[0],B=n[1],P=n[2],E=n[3],C=n[4+0],O=n[4+1],U=n[4+2],V=n[4+3],F=n[8+0],L=n[8+1],G=n[8+2],R=n[8+3],N=n[12+0],D=n[12+1],_=n[12+2],X=n[12+3];return o[0]=r*T+h*B+a*P+y*E,o[1]=t*T+l*B+u*P+s*E,o[2]=i*T+p*B+w*P+z*E,o[3]=c*T+f*B+M*P+x*E,o[4]=r*C+h*O+a*U+y*V,o[5]=t*C+l*O+u*U+s*V,o[6]=i*C+p*O+w*U+z*V,o[7]=c*C+f*O+M*U+x*V,o[8]=r*F+h*L+a*G+y*R,o[9]=t*F+l*L+u*G+s*R,o[10]=i*F+p*L+w*G+z*R,o[11]=c*F+f*L+M*G+x*R,o[12]=r*N+h*D+a*_+y*X,o[13]=t*N+l*D+u*_+s*X,o[14]=i*N+p*D+w*_+z*X,o[15]=c*N+f*D+M*_+x*X,o}const we=zn;function ye(e,n,o){return o=o||xn(),e!==o&&(o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11]),o[12]=n[0],o[13]=n[1],o[14]=n[2],o[15]=1,o}function xe(e,n){return n=n||I(),n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function ge(e,n,o){o=o||I();const r=n*4;return o[0]=e[r+0],o[1]=e[r+1],o[2]=e[r+2],o}function ze(e,n,o,r){r!==e&&(r=en(e,r));const t=o*4;return r[t+0]=n[0],r[t+1]=n[1],r[t+2]=n[2],r}function $e(e,n){n=n||I();const o=e[0],r=e[1],t=e[2],i=e[4],c=e[5],h=e[6],l=e[8],p=e[9],f=e[10];return n[0]=Math.sqrt(o*o+r*r+t*t),n[1]=Math.sqrt(i*i+c*c+h*h),n[2]=Math.sqrt(l*l+p*p+f*f),n}function Ae(e,n,o,r,t){t=t||new A(16);const i=Math.tan(Math.PI*.5-.5*e);if(t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r===1/0)t[10]=-1,t[14]=-o;else{const c=1/(o-r);t[10]=r*c,t[14]=r*o*c}return t}function Se(e,n,o,r,t,i,c){return c=c||new A(16),c[0]=2/(n-e),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=2/(r-o),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1/(t-i),c[11]=0,c[12]=(n+e)/(e-n),c[13]=(r+o)/(o-r),c[14]=t/(t-i),c[15]=1,c}function ve(e,n,o,r,t,i,c){c=c||new A(16);const h=n-e,l=r-o,p=t-i;return c[0]=2*t/h,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=2*t/l,c[6]=0,c[7]=0,c[8]=(e+n)/h,c[9]=(r+o)/l,c[10]=i/p,c[11]=-1,c[12]=0,c[13]=0,c[14]=t*i/p,c[15]=0,c}let S,v,$;function Te(e,n,o,r){return r=r||new A(16),S=S||I(),v=v||I(),$=$||I(),W(b(n,e,$),$),W(Y(o,$,S),S),W(Y($,S,v),v),r[0]=S[0],r[1]=S[1],r[2]=S[2],r[3]=0,r[4]=v[0],r[5]=v[1],r[6]=v[2],r[7]=0,r[8]=$[0],r[9]=$[1],r[10]=$[2],r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Be(e,n,o,r){return r=r||new A(16),S=S||I(),v=v||I(),$=$||I(),W(b(e,n,$),$),W(Y(o,$,S),S),W(Y($,S,v),v),r[0]=S[0],r[1]=S[1],r[2]=S[2],r[3]=0,r[4]=v[0],r[5]=v[1],r[6]=v[2],r[7]=0,r[8]=$[0],r[9]=$[1],r[10]=$[2],r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Pe(e,n,o,r){return r=r||new A(16),S=S||I(),v=v||I(),$=$||I(),W(b(e,n,$),$),W(Y(o,$,S),S),W(Y($,S,v),v),r[0]=S[0],r[1]=v[0],r[2]=$[0],r[3]=0,r[4]=S[1],r[5]=v[1],r[6]=$[1],r[7]=0,r[8]=S[2],r[9]=v[2],r[10]=$[2],r[11]=0,r[12]=-(S[0]*e[0]+S[1]*e[1]+S[2]*e[2]),r[13]=-(v[0]*e[0]+v[1]*e[1]+v[2]*e[2]),r[14]=-($[0]*e[0]+$[1]*e[1]+$[2]*e[2]),r[15]=1,r}function qe(e,n){return n=n||new A(16),n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function Ee(e,n,o){o=o||new A(16);const r=n[0],t=n[1],i=n[2],c=e[0],h=e[1],l=e[2],p=e[3],f=e[1*4+0],a=e[1*4+1],u=e[1*4+2],w=e[1*4+3],M=e[2*4+0],y=e[2*4+1],s=e[2*4+2],z=e[2*4+3],x=e[3*4+0],T=e[3*4+1],B=e[3*4+2],P=e[3*4+3];return e!==o&&(o[0]=c,o[1]=h,o[2]=l,o[3]=p,o[4]=f,o[5]=a,o[6]=u,o[7]=w,o[8]=M,o[9]=y,o[10]=s,o[11]=z),o[12]=c*r+f*t+M*i+x,o[13]=h*r+a*t+y*i+T,o[14]=l*r+u*t+s*i+B,o[15]=p*r+w*t+z*i+P,o}function Ce(e,n){n=n||new A(16);const o=Math.cos(e),r=Math.sin(e);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o,n[6]=r,n[7]=0,n[8]=0,n[9]=-r,n[10]=o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Oe(e,n,o){o=o||new A(16);const r=e[4],t=e[5],i=e[6],c=e[7],h=e[8],l=e[9],p=e[10],f=e[11],a=Math.cos(n),u=Math.sin(n);return o[4]=a*r+u*h,o[5]=a*t+u*l,o[6]=a*i+u*p,o[7]=a*c+u*f,o[8]=a*h-u*r,o[9]=a*l-u*t,o[10]=a*p-u*i,o[11]=a*f-u*c,e!==o&&(o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function Ue(e,n){n=n||new A(16);const o=Math.cos(e),r=Math.sin(e);return n[0]=o,n[1]=0,n[2]=-r,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=r,n[9]=0,n[10]=o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Ve(e,n,o){o=o||new A(16);const r=e[0*4+0],t=e[0*4+1],i=e[0*4+2],c=e[0*4+3],h=e[2*4+0],l=e[2*4+1],p=e[2*4+2],f=e[2*4+3],a=Math.cos(n),u=Math.sin(n);return o[0]=a*r-u*h,o[1]=a*t-u*l,o[2]=a*i-u*p,o[3]=a*c-u*f,o[8]=a*h+u*r,o[9]=a*l+u*t,o[10]=a*p+u*i,o[11]=a*f+u*c,e!==o&&(o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function Fe(e,n){n=n||new A(16);const o=Math.cos(e),r=Math.sin(e);return n[0]=o,n[1]=r,n[2]=0,n[3]=0,n[4]=-r,n[5]=o,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Le(e,n,o){o=o||new A(16);const r=e[0*4+0],t=e[0*4+1],i=e[0*4+2],c=e[0*4+3],h=e[1*4+0],l=e[1*4+1],p=e[1*4+2],f=e[1*4+3],a=Math.cos(n),u=Math.sin(n);return o[0]=a*r+u*h,o[1]=a*t+u*l,o[2]=a*i+u*p,o[3]=a*c+u*f,o[4]=a*h-u*r,o[5]=a*l-u*t,o[6]=a*p-u*i,o[7]=a*f-u*c,e!==o&&(o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function $n(e,n,o){o=o||new A(16);let r=e[0],t=e[1],i=e[2];const c=Math.sqrt(r*r+t*t+i*i);r/=c,t/=c,i/=c;const h=r*r,l=t*t,p=i*i,f=Math.cos(n),a=Math.sin(n),u=1-f;return o[0]=h+(1-h)*f,o[1]=r*t*u+i*a,o[2]=r*i*u-t*a,o[3]=0,o[4]=r*t*u-i*a,o[5]=l+(1-l)*f,o[6]=t*i*u+r*a,o[7]=0,o[8]=r*i*u+t*a,o[9]=t*i*u-r*a,o[10]=p+(1-p)*f,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}const me=$n;function An(e,n,o,r){r=r||new A(16);let t=n[0],i=n[1],c=n[2];const h=Math.sqrt(t*t+i*i+c*c);t/=h,i/=h,c/=h;const l=t*t,p=i*i,f=c*c,a=Math.cos(o),u=Math.sin(o),w=1-a,M=l+(1-l)*a,y=t*i*w+c*u,s=t*c*w-i*u,z=t*i*w-c*u,x=p+(1-p)*a,T=i*c*w+t*u,B=t*c*w+i*u,P=i*c*w-t*u,E=f+(1-f)*a,C=e[0],O=e[1],U=e[2],V=e[3],F=e[4],L=e[5],G=e[6],R=e[7],N=e[8],D=e[9],_=e[10],X=e[11];return r[0]=M*C+y*F+s*N,r[1]=M*O+y*L+s*D,r[2]=M*U+y*G+s*_,r[3]=M*V+y*R+s*X,r[4]=z*C+x*F+T*N,r[5]=z*O+x*L+T*D,r[6]=z*U+x*G+T*_,r[7]=z*V+x*R+T*X,r[8]=B*C+P*F+E*N,r[9]=B*O+P*L+E*D,r[10]=B*U+P*G+E*_,r[11]=B*V+P*R+E*X,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r}const Ge=An;function Re(e,n){return n=n||new A(16),n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Ne(e,n,o){o=o||new A(16);const r=n[0],t=n[1],i=n[2];return o[0]=r*e[0*4+0],o[1]=r*e[0*4+1],o[2]=r*e[0*4+2],o[3]=r*e[0*4+3],o[4]=t*e[1*4+0],o[5]=t*e[1*4+1],o[6]=t*e[1*4+2],o[7]=t*e[1*4+3],o[8]=i*e[2*4+0],o[9]=i*e[2*4+1],o[10]=i*e[2*4+2],o[11]=i*e[2*4+3],e!==o&&(o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}var Z=Object.freeze({__proto__:null,setDefaultType:te,create:ce,fromMat3:ie,fromQuat:ae,negate:ue,copy:en,clone:he,equalsApproximately:fe,equals:le,identity:xn,transpose:pe,inverse:gn,determinant:se,invert:Me,multiply:zn,mul:we,setTranslation:ye,getTranslation:xe,getAxis:ge,setAxis:ze,getScaling:$e,perspective:Ae,ortho:Se,frustum:ve,aim:Te,cameraAim:Be,lookAt:Pe,translation:qe,translate:Ee,rotationX:Ce,rotateX:Oe,rotationY:Ue,rotateY:Ve,rotationZ:Fe,rotateZ:Le,axisRotation:$n,rotation:me,axisRotate:An,rotate:Ge,scaling:Re,scale:Ne});const De=new Float32Array([1,-1,0,-1,-1,0,0,1,0]),Ie=new Float32Array([1,0,0,1,0,1,0,1,0,0,1,1]),_e=new Uint16Array([0,1,2,0]);class Xe{constructor(n){this.modelMatrix=Z.identity(),this.viewMatrix=Z.identity(),this.perspectiveMatrix=Z.identity(),this.eye=nn.create(0,0,5),this.zNear=.1,this.zFar=1e3,this.sampleCount=4,this.onMouseWheel=o=>{let r=this.eye[2]+=o.deltaY*.01;r=Math.max(this.zNear,Math.min(this.zFar,r)),this.eye[2]=r},this.render=()=>{const o=.5*Math.PI/180;Z.rotateZ(this.modelMatrix,o,this.modelMatrix),this.updateUniformBuffer(),this.encodeCommands(),requestAnimationFrame(this.render)},this.canvas=n,this.updateViewMatrix(),this.updatePerspectiveMatrix()}updatePerspectiveMatrix(){const n=this.canvas.width/this.canvas.height,o=45*Math.PI/180;this.perspectiveMatrix=Z.perspective(o,n,this.zNear,this.zFar)}updateViewMatrix(){const n=nn.create(0,0,0),o=nn.create(0,1,0);this.viewMatrix=Z.lookAt(this.eye,n,o)}resize(n,o){(n!==this.presentationSize.width||o!==this.presentationSize.height)&&(this.canvas.width=n,this.canvas.height=o,this.presentationSize={width:n,height:o,depthOrArrayLayers:1},this.updatePerspectiveMatrix(),this.resizeSwapchain())}async initialize(){const n=navigator.gpu;if(!n)return console.error("No WebGPU support navigator.gpu not available!"),!1;const o=await n.requestAdapter();return console.log(o.limits),this.device=await o.requestDevice(),this.queue=this.device.queue,this.canvas.style.display="block",this.canvas.addEventListener("wheel",this.onMouseWheel),this.presentationSize={width:this.canvas.width,height:this.canvas.height,depthOrArrayLayers:1},this.presentationContext=this.canvas.getContext("webgpu"),this.presentationFormat=n.getPreferredCanvasFormat(),this.presentationContext.configure({device:this.device,format:this.presentationFormat,alphaMode:"opaque"}),new ResizeObserver(t=>{Array.isArray(t)&&this.resize(t[0].contentRect.width*window.devicePixelRatio,t[0].contentRect.height*window.devicePixelRatio)}).observe(this.canvas),!0}createBuffer(n,o){try{const r=this.device.createBuffer({mappedAtCreation:!0,size:n.byteLength,usage:o}),t=r.getMappedRange();return(n instanceof Float32Array?new Float32Array(t):new Uint16Array(t)).set(n),r.unmap(),r}catch(r){console.error(r)}}createUBOArray(){const n=new Float32Array(48);return n.set(this.modelMatrix),n.set(this.viewMatrix,16),n.set(this.perspectiveMatrix,32),n}updateUniformBuffer(){this.updateViewMatrix();const n=this.createUBOArray();this.queue.writeBuffer(this.uniformBuffer,0,n.buffer)}async loadShader(n){const o=await fetch(n);return this.device.createShaderModule({code:await o.text()})}resizeSwapchain(){this.renderTarget!==void 0&&(this.renderTarget.destroy(),this.depthTarget.destroy()),this.renderTarget=this.device.createTexture({size:this.presentationSize,sampleCount:this.sampleCount,format:this.presentationFormat,usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.renderTargetView=this.renderTarget.createView(),this.depthTarget=this.device.createTexture({size:this.presentationSize,sampleCount:this.sampleCount,format:"depth24plus-stencil8",usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.depthTargetView=this.depthTarget.createView()}encodeCommands(){const n={view:this.presentationContext.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"};this.sampleCount>1&&(n.view=this.renderTargetView,n.resolveTarget=this.presentationContext.getCurrentTexture().createView());const o={view:this.depthTargetView,depthLoadOp:"clear",depthClearValue:1,depthStoreOp:"store",stencilLoadOp:"clear",stencilClearValue:0,stencilStoreOp:"store"},r={colorAttachments:[n],depthStencilAttachment:o};this.commandEncoder=this.device.createCommandEncoder(),this.passEncoder=this.commandEncoder.beginRenderPass(r),this.passEncoder.setPipeline(this.renderPipeline),this.passEncoder.setBindGroup(0,this.uniformBindGroup),this.passEncoder.setViewport(0,0,this.canvas.width,this.canvas.height,0,1),this.passEncoder.setScissorRect(0,0,this.canvas.width,this.canvas.height),this.passEncoder.setVertexBuffer(0,this.positionBuffer),this.passEncoder.setVertexBuffer(1,this.colorBuffer),this.passEncoder.setIndexBuffer(this.indexBuffer,"uint16"),this.passEncoder.drawIndexed(3,1,0,0,0),this.passEncoder.end(),this.queue.submit([this.commandEncoder.finish()])}async initializeResources(){this.positionBuffer=this.createBuffer(De,GPUBufferUsage.VERTEX),this.colorBuffer=this.createBuffer(Ie,GPUBufferUsage.VERTEX),this.indexBuffer=this.createBuffer(_e,GPUBufferUsage.INDEX);const n=this.createUBOArray();this.uniformBuffer=this.createBuffer(n,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),this.vertexModule=await this.loadShader("./shaders/basic.vert.wgsl"),this.fragmentModule=await this.loadShader("./shaders/basic.frag.wgsl");const o={shaderLocation:0,offset:0,format:"float32x3"},r={shaderLocation:1,offset:0,format:"float32x4"},t={attributes:[o],arrayStride:4*3,stepMode:"vertex"},i={attributes:[r],arrayStride:4*4,stepMode:"vertex"},c={depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus-stencil8"},h=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}}]});this.uniformBindGroup=this.device.createBindGroup({layout:h,entries:[{binding:0,resource:{buffer:this.uniformBuffer}}]});const l={bindGroupLayouts:[h]},p=this.device.createPipelineLayout(l),f={module:this.vertexModule,entryPoint:"main",buffers:[t,i]},a={format:"bgra8unorm",blend:{alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}},writeMask:GPUColorWrite.ALL},u={module:this.fragmentModule,entryPoint:"main",targets:[a]},w={layout:p,vertex:f,fragment:u,primitive:{topology:"triangle-list",frontFace:"cw",cullMode:"none"},depthStencil:c,multisample:{count:this.sampleCount}};this.renderPipeline=this.device.createRenderPipeline(w)}async start(){if(await this.initialize())this.resizeSwapchain(),await this.initializeResources(),this.render();else{const n=document.getElementById("error");n.style.display="block"}}}const We=document.getElementById("webgpu_canvas"),Ye=new Xe(We);Ye.start();
