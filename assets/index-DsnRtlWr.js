var ct=Object.defineProperty;var ot=(a,x,v)=>x in a?ct(a,x,{enumerable:!0,configurable:!0,writable:!0,value:v}):a[x]=v;var H=(a,x,v)=>ot(a,typeof x!="symbol"?x+"":x,v);(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const X of document.querySelectorAll('link[rel="modulepreload"]'))_(X);new MutationObserver(X=>{for(const Q of X)if(Q.type==="childList")for(const m of Q.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&_(m)}).observe(document,{childList:!0,subtree:!0});function v(X){const Q={};return X.integrity&&(Q.integrity=X.integrity),X.referrerPolicy&&(Q.referrerPolicy=X.referrerPolicy),X.crossOrigin==="use-credentials"?Q.credentials="include":X.crossOrigin==="anonymous"?Q.credentials="omit":Q.credentials="same-origin",Q}function _(X){if(X.ep)return;X.ep=!0;const Q=v(X);fetch(X.href,Q)}})();function rt(a,x){return class extends a{constructor(...v){super(...v),x(this)}}}const it=rt(Array,a=>a.fill(0));let $=1e-6;function ut(a){function x(n=0,c=0){const t=new a(2);return n!==void 0&&(t[0]=n,c!==void 0&&(t[1]=c)),t}const v=x;function _(n,c,t){const e=t??new a(2);return e[0]=n,e[1]=c,e}function X(n,c){const t=c??new a(2);return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function Q(n,c){const t=c??new a(2);return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function m(n,c){const t=c??new a(2);return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function nn(n,c=0,t=1,e){const u=e??new a(2);return u[0]=Math.min(t,Math.max(c,n[0])),u[1]=Math.min(t,Math.max(c,n[1])),u}function tn(n,c,t){const e=t??new a(2);return e[0]=n[0]+c[0],e[1]=n[1]+c[1],e}function gn(n,c,t,e){const u=e??new a(2);return u[0]=n[0]+c[0]*t,u[1]=n[1]+c[1]*t,u}function Dn(n,c){const t=n[0],e=n[1],u=c[0],M=c[1],S=Math.sqrt(t*t+e*e),s=Math.sqrt(u*u+M*M),i=S*s,l=i&&Bn(n,c)/i;return Math.acos(l)}function en(n,c,t){const e=t??new a(2);return e[0]=n[0]-c[0],e[1]=n[1]-c[1],e}const yn=en;function fn(n,c){return Math.abs(n[0]-c[0])<$&&Math.abs(n[1]-c[1])<$}function zn(n,c){return n[0]===c[0]&&n[1]===c[1]}function An(n,c,t,e){const u=e??new a(2);return u[0]=n[0]+t*(c[0]-n[0]),u[1]=n[1]+t*(c[1]-n[1]),u}function Vn(n,c,t,e){const u=e??new a(2);return u[0]=n[0]+t[0]*(c[0]-n[0]),u[1]=n[1]+t[1]*(c[1]-n[1]),u}function Fn(n,c,t){const e=t??new a(2);return e[0]=Math.max(n[0],c[0]),e[1]=Math.max(n[1],c[1]),e}function xn(n,c,t){const e=t??new a(2);return e[0]=Math.min(n[0],c[0]),e[1]=Math.min(n[1],c[1]),e}function wn(n,c,t){const e=t??new a(2);return e[0]=n[0]*c,e[1]=n[1]*c,e}const vn=wn;function Sn(n,c,t){const e=t??new a(2);return e[0]=n[0]/c,e[1]=n[1]/c,e}function qn(n,c){const t=c??new a(2);return t[0]=1/n[0],t[1]=1/n[1],t}const On=qn;function Pn(n,c,t){const e=t??new a(3),u=n[0]*c[1]-n[1]*c[0];return e[0]=0,e[1]=0,e[2]=u,e}function Bn(n,c){return n[0]*c[0]+n[1]*c[1]}function b(n){const c=n[0],t=n[1];return Math.sqrt(c*c+t*t)}const Un=b;function W(n){const c=n[0],t=n[1];return c*c+t*t}const j=W;function Z(n,c){const t=n[0]-c[0],e=n[1]-c[1];return Math.sqrt(t*t+e*e)}const Ln=Z;function hn(n,c){const t=n[0]-c[0],e=n[1]-c[1];return t*t+e*e}const f=hn;function P(n,c){const t=c??new a(2),e=n[0],u=n[1],M=Math.sqrt(e*e+u*u);return M>1e-5?(t[0]=e/M,t[1]=u/M):(t[0]=0,t[1]=0),t}function D(n,c){const t=c??new a(2);return t[0]=-n[0],t[1]=-n[1],t}function z(n,c){const t=c??new a(2);return t[0]=n[0],t[1]=n[1],t}const E=z;function I(n,c,t){const e=t??new a(2);return e[0]=n[0]*c[0],e[1]=n[1]*c[1],e}const L=I;function G(n,c,t){const e=t??new a(2);return e[0]=n[0]/c[0],e[1]=n[1]/c[1],e}const R=G;function O(n=1,c){const t=c??new a(2),e=Math.random()*2*Math.PI;return t[0]=Math.cos(e)*n,t[1]=Math.sin(e)*n,t}function h(n){const c=n??new a(2);return c[0]=0,c[1]=0,c}function g(n,c,t){const e=t??new a(2),u=n[0],M=n[1];return e[0]=u*c[0]+M*c[4]+c[12],e[1]=u*c[1]+M*c[5]+c[13],e}function o(n,c,t){const e=t??new a(2),u=n[0],M=n[1];return e[0]=c[0]*u+c[4]*M+c[8],e[1]=c[1]*u+c[5]*M+c[9],e}function r(n,c,t,e){const u=e??new a(2),M=n[0]-c[0],S=n[1]-c[1],s=Math.sin(t),i=Math.cos(t);return u[0]=M*i-S*s+c[0],u[1]=M*s+S*i+c[1],u}function w(n,c,t){const e=t??new a(2);return P(n,e),wn(e,c,e)}function d(n,c,t){const e=t??new a(2);return b(n)>c?w(n,c,e):z(n,e)}function B(n,c,t){const e=t??new a(2);return An(n,c,.5,e)}return{create:x,fromValues:v,set:_,ceil:X,floor:Q,round:m,clamp:nn,add:tn,addScaled:gn,angle:Dn,subtract:en,sub:yn,equalsApproximately:fn,equals:zn,lerp:An,lerpV:Vn,max:Fn,min:xn,mulScalar:wn,scale:vn,divScalar:Sn,inverse:qn,invert:On,cross:Pn,dot:Bn,length:b,len:Un,lengthSq:W,lenSq:j,distance:Z,dist:Ln,distanceSq:hn,distSq:f,normalize:P,negate:D,copy:z,clone:E,multiply:I,mul:L,divide:G,div:R,random:O,zero:h,transformMat4:g,transformMat3:o,rotate:r,setLength:w,truncate:d,midpoint:B}}const mn=new Map;function st(a){let x=mn.get(a);return x||(x=ut(a),mn.set(a,x)),x}function at(a){function x(s,i,l){const p=new a(3);return s!==void 0&&(p[0]=s,i!==void 0&&(p[1]=i,l!==void 0&&(p[2]=l))),p}const v=x;function _(s,i,l,p){const y=p??new a(3);return y[0]=s,y[1]=i,y[2]=l,y}function X(s,i){const l=i??new a(3);return l[0]=Math.ceil(s[0]),l[1]=Math.ceil(s[1]),l[2]=Math.ceil(s[2]),l}function Q(s,i){const l=i??new a(3);return l[0]=Math.floor(s[0]),l[1]=Math.floor(s[1]),l[2]=Math.floor(s[2]),l}function m(s,i){const l=i??new a(3);return l[0]=Math.round(s[0]),l[1]=Math.round(s[1]),l[2]=Math.round(s[2]),l}function nn(s,i=0,l=1,p){const y=p??new a(3);return y[0]=Math.min(l,Math.max(i,s[0])),y[1]=Math.min(l,Math.max(i,s[1])),y[2]=Math.min(l,Math.max(i,s[2])),y}function tn(s,i,l){const p=l??new a(3);return p[0]=s[0]+i[0],p[1]=s[1]+i[1],p[2]=s[2]+i[2],p}function gn(s,i,l,p){const y=p??new a(3);return y[0]=s[0]+i[0]*l,y[1]=s[1]+i[1]*l,y[2]=s[2]+i[2]*l,y}function Dn(s,i){const l=s[0],p=s[1],y=s[2],A=i[0],q=i[1],F=i[2],U=Math.sqrt(l*l+p*p+y*y),T=Math.sqrt(A*A+q*q+F*F),V=U*T,N=V&&Bn(s,i)/V;return Math.acos(N)}function en(s,i,l){const p=l??new a(3);return p[0]=s[0]-i[0],p[1]=s[1]-i[1],p[2]=s[2]-i[2],p}const yn=en;function fn(s,i){return Math.abs(s[0]-i[0])<$&&Math.abs(s[1]-i[1])<$&&Math.abs(s[2]-i[2])<$}function zn(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]}function An(s,i,l,p){const y=p??new a(3);return y[0]=s[0]+l*(i[0]-s[0]),y[1]=s[1]+l*(i[1]-s[1]),y[2]=s[2]+l*(i[2]-s[2]),y}function Vn(s,i,l,p){const y=p??new a(3);return y[0]=s[0]+l[0]*(i[0]-s[0]),y[1]=s[1]+l[1]*(i[1]-s[1]),y[2]=s[2]+l[2]*(i[2]-s[2]),y}function Fn(s,i,l){const p=l??new a(3);return p[0]=Math.max(s[0],i[0]),p[1]=Math.max(s[1],i[1]),p[2]=Math.max(s[2],i[2]),p}function xn(s,i,l){const p=l??new a(3);return p[0]=Math.min(s[0],i[0]),p[1]=Math.min(s[1],i[1]),p[2]=Math.min(s[2],i[2]),p}function wn(s,i,l){const p=l??new a(3);return p[0]=s[0]*i,p[1]=s[1]*i,p[2]=s[2]*i,p}const vn=wn;function Sn(s,i,l){const p=l??new a(3);return p[0]=s[0]/i,p[1]=s[1]/i,p[2]=s[2]/i,p}function qn(s,i){const l=i??new a(3);return l[0]=1/s[0],l[1]=1/s[1],l[2]=1/s[2],l}const On=qn;function Pn(s,i,l){const p=l??new a(3),y=s[2]*i[0]-s[0]*i[2],A=s[0]*i[1]-s[1]*i[0];return p[0]=s[1]*i[2]-s[2]*i[1],p[1]=y,p[2]=A,p}function Bn(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]}function b(s){const i=s[0],l=s[1],p=s[2];return Math.sqrt(i*i+l*l+p*p)}const Un=b;function W(s){const i=s[0],l=s[1],p=s[2];return i*i+l*l+p*p}const j=W;function Z(s,i){const l=s[0]-i[0],p=s[1]-i[1],y=s[2]-i[2];return Math.sqrt(l*l+p*p+y*y)}const Ln=Z;function hn(s,i){const l=s[0]-i[0],p=s[1]-i[1],y=s[2]-i[2];return l*l+p*p+y*y}const f=hn;function P(s,i){const l=i??new a(3),p=s[0],y=s[1],A=s[2],q=Math.sqrt(p*p+y*y+A*A);return q>1e-5?(l[0]=p/q,l[1]=y/q,l[2]=A/q):(l[0]=0,l[1]=0,l[2]=0),l}function D(s,i){const l=i??new a(3);return l[0]=-s[0],l[1]=-s[1],l[2]=-s[2],l}function z(s,i){const l=i??new a(3);return l[0]=s[0],l[1]=s[1],l[2]=s[2],l}const E=z;function I(s,i,l){const p=l??new a(3);return p[0]=s[0]*i[0],p[1]=s[1]*i[1],p[2]=s[2]*i[2],p}const L=I;function G(s,i,l){const p=l??new a(3);return p[0]=s[0]/i[0],p[1]=s[1]/i[1],p[2]=s[2]/i[2],p}const R=G;function O(s=1,i){const l=i??new a(3),p=Math.random()*2*Math.PI,y=Math.random()*2-1,A=Math.sqrt(1-y*y)*s;return l[0]=Math.cos(p)*A,l[1]=Math.sin(p)*A,l[2]=y*s,l}function h(s){const i=s??new a(3);return i[0]=0,i[1]=0,i[2]=0,i}function g(s,i,l){const p=l??new a(3),y=s[0],A=s[1],q=s[2],F=i[3]*y+i[7]*A+i[11]*q+i[15]||1;return p[0]=(i[0]*y+i[4]*A+i[8]*q+i[12])/F,p[1]=(i[1]*y+i[5]*A+i[9]*q+i[13])/F,p[2]=(i[2]*y+i[6]*A+i[10]*q+i[14])/F,p}function o(s,i,l){const p=l??new a(3),y=s[0],A=s[1],q=s[2];return p[0]=y*i[0*4+0]+A*i[1*4+0]+q*i[2*4+0],p[1]=y*i[0*4+1]+A*i[1*4+1]+q*i[2*4+1],p[2]=y*i[0*4+2]+A*i[1*4+2]+q*i[2*4+2],p}function r(s,i,l){const p=l??new a(3),y=s[0],A=s[1],q=s[2];return p[0]=y*i[0]+A*i[4]+q*i[8],p[1]=y*i[1]+A*i[5]+q*i[9],p[2]=y*i[2]+A*i[6]+q*i[10],p}function w(s,i,l){const p=l??new a(3),y=i[0],A=i[1],q=i[2],F=i[3]*2,U=s[0],T=s[1],V=s[2],N=A*V-q*T,Y=q*U-y*V,K=y*T-A*U;return p[0]=U+N*F+(A*K-q*Y)*2,p[1]=T+Y*F+(q*N-y*K)*2,p[2]=V+K*F+(y*Y-A*N)*2,p}function d(s,i){const l=i??new a(3);return l[0]=s[12],l[1]=s[13],l[2]=s[14],l}function B(s,i,l){const p=l??new a(3),y=i*4;return p[0]=s[y+0],p[1]=s[y+1],p[2]=s[y+2],p}function n(s,i){const l=i??new a(3),p=s[0],y=s[1],A=s[2],q=s[4],F=s[5],U=s[6],T=s[8],V=s[9],N=s[10];return l[0]=Math.sqrt(p*p+y*y+A*A),l[1]=Math.sqrt(q*q+F*F+U*U),l[2]=Math.sqrt(T*T+V*V+N*N),l}function c(s,i,l,p){const y=p??new a(3),A=[],q=[];return A[0]=s[0]-i[0],A[1]=s[1]-i[1],A[2]=s[2]-i[2],q[0]=A[0],q[1]=A[1]*Math.cos(l)-A[2]*Math.sin(l),q[2]=A[1]*Math.sin(l)+A[2]*Math.cos(l),y[0]=q[0]+i[0],y[1]=q[1]+i[1],y[2]=q[2]+i[2],y}function t(s,i,l,p){const y=p??new a(3),A=[],q=[];return A[0]=s[0]-i[0],A[1]=s[1]-i[1],A[2]=s[2]-i[2],q[0]=A[2]*Math.sin(l)+A[0]*Math.cos(l),q[1]=A[1],q[2]=A[2]*Math.cos(l)-A[0]*Math.sin(l),y[0]=q[0]+i[0],y[1]=q[1]+i[1],y[2]=q[2]+i[2],y}function e(s,i,l,p){const y=p??new a(3),A=[],q=[];return A[0]=s[0]-i[0],A[1]=s[1]-i[1],A[2]=s[2]-i[2],q[0]=A[0]*Math.cos(l)-A[1]*Math.sin(l),q[1]=A[0]*Math.sin(l)+A[1]*Math.cos(l),q[2]=A[2],y[0]=q[0]+i[0],y[1]=q[1]+i[1],y[2]=q[2]+i[2],y}function u(s,i,l){const p=l??new a(3);return P(s,p),wn(p,i,p)}function M(s,i,l){const p=l??new a(3);return b(s)>i?u(s,i,p):z(s,p)}function S(s,i,l){const p=l??new a(3);return An(s,i,.5,p)}return{create:x,fromValues:v,set:_,ceil:X,floor:Q,round:m,clamp:nn,add:tn,addScaled:gn,angle:Dn,subtract:en,sub:yn,equalsApproximately:fn,equals:zn,lerp:An,lerpV:Vn,max:Fn,min:xn,mulScalar:wn,scale:vn,divScalar:Sn,inverse:qn,invert:On,cross:Pn,dot:Bn,length:b,len:Un,lengthSq:W,lenSq:j,distance:Z,dist:Ln,distanceSq:hn,distSq:f,normalize:P,negate:D,copy:z,clone:E,multiply:I,mul:L,divide:G,div:R,random:O,zero:h,transformMat4:g,transformMat4Upper3x3:o,transformMat3:r,transformQuat:w,getTranslation:d,getAxis:B,getScaling:n,rotateX:c,rotateY:t,rotateZ:e,setLength:u,truncate:M,midpoint:S}}const bn=new Map;function Hn(a){let x=bn.get(a);return x||(x=at(a),bn.set(a,x)),x}function ft(a){const x=st(a),v=Hn(a);function _(f,P,D,z,E,I,L,G,R){const O=new a(12);return O[3]=0,O[7]=0,O[11]=0,f!==void 0&&(O[0]=f,P!==void 0&&(O[1]=P,D!==void 0&&(O[2]=D,z!==void 0&&(O[4]=z,E!==void 0&&(O[5]=E,I!==void 0&&(O[6]=I,L!==void 0&&(O[8]=L,G!==void 0&&(O[9]=G,R!==void 0&&(O[10]=R))))))))),O}function X(f,P,D,z,E,I,L,G,R,O){const h=O??new a(12);return h[0]=f,h[1]=P,h[2]=D,h[3]=0,h[4]=z,h[5]=E,h[6]=I,h[7]=0,h[8]=L,h[9]=G,h[10]=R,h[11]=0,h}function Q(f,P){const D=P??new a(12);return D[0]=f[0],D[1]=f[1],D[2]=f[2],D[3]=0,D[4]=f[4],D[5]=f[5],D[6]=f[6],D[7]=0,D[8]=f[8],D[9]=f[9],D[10]=f[10],D[11]=0,D}function m(f,P){const D=P??new a(12),z=f[0],E=f[1],I=f[2],L=f[3],G=z+z,R=E+E,O=I+I,h=z*G,g=E*G,o=E*R,r=I*G,w=I*R,d=I*O,B=L*G,n=L*R,c=L*O;return D[0]=1-o-d,D[1]=g+c,D[2]=r-n,D[3]=0,D[4]=g-c,D[5]=1-h-d,D[6]=w+B,D[7]=0,D[8]=r+n,D[9]=w-B,D[10]=1-h-o,D[11]=0,D}function nn(f,P){const D=P??new a(12);return D[0]=-f[0],D[1]=-f[1],D[2]=-f[2],D[4]=-f[4],D[5]=-f[5],D[6]=-f[6],D[8]=-f[8],D[9]=-f[9],D[10]=-f[10],D}function tn(f,P){const D=P??new a(12);return D[0]=f[0],D[1]=f[1],D[2]=f[2],D[4]=f[4],D[5]=f[5],D[6]=f[6],D[8]=f[8],D[9]=f[9],D[10]=f[10],D}const gn=tn;function Dn(f,P){return Math.abs(f[0]-P[0])<$&&Math.abs(f[1]-P[1])<$&&Math.abs(f[2]-P[2])<$&&Math.abs(f[4]-P[4])<$&&Math.abs(f[5]-P[5])<$&&Math.abs(f[6]-P[6])<$&&Math.abs(f[8]-P[8])<$&&Math.abs(f[9]-P[9])<$&&Math.abs(f[10]-P[10])<$}function en(f,P){return f[0]===P[0]&&f[1]===P[1]&&f[2]===P[2]&&f[4]===P[4]&&f[5]===P[5]&&f[6]===P[6]&&f[8]===P[8]&&f[9]===P[9]&&f[10]===P[10]}function yn(f){const P=f??new a(12);return P[0]=1,P[1]=0,P[2]=0,P[4]=0,P[5]=1,P[6]=0,P[8]=0,P[9]=0,P[10]=1,P}function fn(f,P){const D=P??new a(12);if(D===f){let o;return o=f[1],f[1]=f[4],f[4]=o,o=f[2],f[2]=f[8],f[8]=o,o=f[6],f[6]=f[9],f[9]=o,D}const z=f[0*4+0],E=f[0*4+1],I=f[0*4+2],L=f[1*4+0],G=f[1*4+1],R=f[1*4+2],O=f[2*4+0],h=f[2*4+1],g=f[2*4+2];return D[0]=z,D[1]=L,D[2]=O,D[4]=E,D[5]=G,D[6]=h,D[8]=I,D[9]=R,D[10]=g,D}function zn(f,P){const D=P??new a(12),z=f[0*4+0],E=f[0*4+1],I=f[0*4+2],L=f[1*4+0],G=f[1*4+1],R=f[1*4+2],O=f[2*4+0],h=f[2*4+1],g=f[2*4+2],o=g*G-R*h,r=-g*L+R*O,w=h*L-G*O,d=1/(z*o+E*r+I*w);return D[0]=o*d,D[1]=(-g*E+I*h)*d,D[2]=(R*E-I*G)*d,D[4]=r*d,D[5]=(g*z-I*O)*d,D[6]=(-R*z+I*L)*d,D[8]=w*d,D[9]=(-h*z+E*O)*d,D[10]=(G*z-E*L)*d,D}function An(f){const P=f[0],D=f[0*4+1],z=f[0*4+2],E=f[1*4+0],I=f[1*4+1],L=f[1*4+2],G=f[2*4+0],R=f[2*4+1],O=f[2*4+2];return P*(I*O-R*L)-E*(D*O-R*z)+G*(D*L-I*z)}const Vn=zn;function Fn(f,P,D){const z=D??new a(12),E=f[0],I=f[1],L=f[2],G=f[4],R=f[5],O=f[6],h=f[8],g=f[9],o=f[10],r=P[0],w=P[1],d=P[2],B=P[4],n=P[5],c=P[6],t=P[8],e=P[9],u=P[10];return z[0]=E*r+G*w+h*d,z[1]=I*r+R*w+g*d,z[2]=L*r+O*w+o*d,z[4]=E*B+G*n+h*c,z[5]=I*B+R*n+g*c,z[6]=L*B+O*n+o*c,z[8]=E*t+G*e+h*u,z[9]=I*t+R*e+g*u,z[10]=L*t+O*e+o*u,z}const xn=Fn;function wn(f,P,D){const z=D??yn();return f!==z&&(z[0]=f[0],z[1]=f[1],z[2]=f[2],z[4]=f[4],z[5]=f[5],z[6]=f[6]),z[8]=P[0],z[9]=P[1],z[10]=1,z}function vn(f,P){const D=P??x.create();return D[0]=f[8],D[1]=f[9],D}function Sn(f,P,D){const z=D??x.create(),E=P*4;return z[0]=f[E+0],z[1]=f[E+1],z}function qn(f,P,D,z){const E=z===f?f:tn(f,z),I=D*4;return E[I+0]=P[0],E[I+1]=P[1],E}function On(f,P){const D=P??x.create(),z=f[0],E=f[1],I=f[4],L=f[5];return D[0]=Math.sqrt(z*z+E*E),D[1]=Math.sqrt(I*I+L*L),D}function Pn(f,P){const D=P??v.create(),z=f[0],E=f[1],I=f[2],L=f[4],G=f[5],R=f[6],O=f[8],h=f[9],g=f[10];return D[0]=Math.sqrt(z*z+E*E+I*I),D[1]=Math.sqrt(L*L+G*G+R*R),D[2]=Math.sqrt(O*O+h*h+g*g),D}function Bn(f,P){const D=P??new a(12);return D[0]=1,D[1]=0,D[2]=0,D[4]=0,D[5]=1,D[6]=0,D[8]=f[0],D[9]=f[1],D[10]=1,D}function b(f,P,D){const z=D??new a(12),E=P[0],I=P[1],L=f[0],G=f[1],R=f[2],O=f[1*4+0],h=f[1*4+1],g=f[1*4+2],o=f[2*4+0],r=f[2*4+1],w=f[2*4+2];return f!==z&&(z[0]=L,z[1]=G,z[2]=R,z[4]=O,z[5]=h,z[6]=g),z[8]=L*E+O*I+o,z[9]=G*E+h*I+r,z[10]=R*E+g*I+w,z}function Un(f,P){const D=P??new a(12),z=Math.cos(f),E=Math.sin(f);return D[0]=z,D[1]=E,D[2]=0,D[4]=-E,D[5]=z,D[6]=0,D[8]=0,D[9]=0,D[10]=1,D}function W(f,P,D){const z=D??new a(12),E=f[0*4+0],I=f[0*4+1],L=f[0*4+2],G=f[1*4+0],R=f[1*4+1],O=f[1*4+2],h=Math.cos(P),g=Math.sin(P);return z[0]=h*E+g*G,z[1]=h*I+g*R,z[2]=h*L+g*O,z[4]=h*G-g*E,z[5]=h*R-g*I,z[6]=h*O-g*L,f!==z&&(z[8]=f[8],z[9]=f[9],z[10]=f[10]),z}function j(f,P){const D=P??new a(12);return D[0]=f[0],D[1]=0,D[2]=0,D[4]=0,D[5]=f[1],D[6]=0,D[8]=0,D[9]=0,D[10]=1,D}function Z(f,P,D){const z=D??new a(12),E=P[0],I=P[1];return z[0]=E*f[0*4+0],z[1]=E*f[0*4+1],z[2]=E*f[0*4+2],z[4]=I*f[1*4+0],z[5]=I*f[1*4+1],z[6]=I*f[1*4+2],f!==z&&(z[8]=f[8],z[9]=f[9],z[10]=f[10]),z}function Ln(f,P){const D=P??new a(12);return D[0]=f,D[1]=0,D[2]=0,D[4]=0,D[5]=f,D[6]=0,D[8]=0,D[9]=0,D[10]=1,D}function hn(f,P,D){const z=D??new a(12);return z[0]=P*f[0*4+0],z[1]=P*f[0*4+1],z[2]=P*f[0*4+2],z[4]=P*f[1*4+0],z[5]=P*f[1*4+1],z[6]=P*f[1*4+2],f!==z&&(z[8]=f[8],z[9]=f[9],z[10]=f[10]),z}return{clone:gn,create:_,set:X,fromMat4:Q,fromQuat:m,negate:nn,copy:tn,equalsApproximately:Dn,equals:en,identity:yn,transpose:fn,inverse:zn,invert:Vn,determinant:An,mul:xn,multiply:Fn,setTranslation:wn,getTranslation:vn,getAxis:Sn,setAxis:qn,getScaling:On,get3DScaling:Pn,translation:Bn,translate:b,rotation:Un,rotate:W,scaling:j,scale:Z,uniformScaling:Ln,uniformScale:hn}}const Cn=new Map;function wt(a){let x=Cn.get(a);return x||(x=ft(a),Cn.set(a,x)),x}function ht(a){const x=Hn(a);function v(n,c,t,e,u,M,S,s,i,l,p,y,A,q,F,U){const T=new a(16);return n!==void 0&&(T[0]=n,c!==void 0&&(T[1]=c,t!==void 0&&(T[2]=t,e!==void 0&&(T[3]=e,u!==void 0&&(T[4]=u,M!==void 0&&(T[5]=M,S!==void 0&&(T[6]=S,s!==void 0&&(T[7]=s,i!==void 0&&(T[8]=i,l!==void 0&&(T[9]=l,p!==void 0&&(T[10]=p,y!==void 0&&(T[11]=y,A!==void 0&&(T[12]=A,q!==void 0&&(T[13]=q,F!==void 0&&(T[14]=F,U!==void 0&&(T[15]=U)))))))))))))))),T}function _(n,c,t,e,u,M,S,s,i,l,p,y,A,q,F,U,T){const V=T??new a(16);return V[0]=n,V[1]=c,V[2]=t,V[3]=e,V[4]=u,V[5]=M,V[6]=S,V[7]=s,V[8]=i,V[9]=l,V[10]=p,V[11]=y,V[12]=A,V[13]=q,V[14]=F,V[15]=U,V}function X(n,c){const t=c??new a(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=0,t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=0,t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Q(n,c){const t=c??new a(16),e=n[0],u=n[1],M=n[2],S=n[3],s=e+e,i=u+u,l=M+M,p=e*s,y=u*s,A=u*i,q=M*s,F=M*i,U=M*l,T=S*s,V=S*i,N=S*l;return t[0]=1-A-U,t[1]=y+N,t[2]=q-V,t[3]=0,t[4]=y-N,t[5]=1-p-U,t[6]=F+T,t[7]=0,t[8]=q+V,t[9]=F-T,t[10]=1-p-A,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function m(n,c){const t=c??new a(16);return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=-n[7],t[8]=-n[8],t[9]=-n[9],t[10]=-n[10],t[11]=-n[11],t[12]=-n[12],t[13]=-n[13],t[14]=-n[14],t[15]=-n[15],t}function nn(n,c){const t=c??new a(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}const tn=nn;function gn(n,c){return Math.abs(n[0]-c[0])<$&&Math.abs(n[1]-c[1])<$&&Math.abs(n[2]-c[2])<$&&Math.abs(n[3]-c[3])<$&&Math.abs(n[4]-c[4])<$&&Math.abs(n[5]-c[5])<$&&Math.abs(n[6]-c[6])<$&&Math.abs(n[7]-c[7])<$&&Math.abs(n[8]-c[8])<$&&Math.abs(n[9]-c[9])<$&&Math.abs(n[10]-c[10])<$&&Math.abs(n[11]-c[11])<$&&Math.abs(n[12]-c[12])<$&&Math.abs(n[13]-c[13])<$&&Math.abs(n[14]-c[14])<$&&Math.abs(n[15]-c[15])<$}function Dn(n,c){return n[0]===c[0]&&n[1]===c[1]&&n[2]===c[2]&&n[3]===c[3]&&n[4]===c[4]&&n[5]===c[5]&&n[6]===c[6]&&n[7]===c[7]&&n[8]===c[8]&&n[9]===c[9]&&n[10]===c[10]&&n[11]===c[11]&&n[12]===c[12]&&n[13]===c[13]&&n[14]===c[14]&&n[15]===c[15]}function en(n){const c=n??new a(16);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function yn(n,c){const t=c??new a(16);if(t===n){let Y;return Y=n[1],n[1]=n[4],n[4]=Y,Y=n[2],n[2]=n[8],n[8]=Y,Y=n[3],n[3]=n[12],n[12]=Y,Y=n[6],n[6]=n[9],n[9]=Y,Y=n[7],n[7]=n[13],n[13]=Y,Y=n[11],n[11]=n[14],n[14]=Y,t}const e=n[0*4+0],u=n[0*4+1],M=n[0*4+2],S=n[0*4+3],s=n[1*4+0],i=n[1*4+1],l=n[1*4+2],p=n[1*4+3],y=n[2*4+0],A=n[2*4+1],q=n[2*4+2],F=n[2*4+3],U=n[3*4+0],T=n[3*4+1],V=n[3*4+2],N=n[3*4+3];return t[0]=e,t[1]=s,t[2]=y,t[3]=U,t[4]=u,t[5]=i,t[6]=A,t[7]=T,t[8]=M,t[9]=l,t[10]=q,t[11]=V,t[12]=S,t[13]=p,t[14]=F,t[15]=N,t}function fn(n,c){const t=c??new a(16),e=n[0*4+0],u=n[0*4+1],M=n[0*4+2],S=n[0*4+3],s=n[1*4+0],i=n[1*4+1],l=n[1*4+2],p=n[1*4+3],y=n[2*4+0],A=n[2*4+1],q=n[2*4+2],F=n[2*4+3],U=n[3*4+0],T=n[3*4+1],V=n[3*4+2],N=n[3*4+3],Y=q*N,K=V*F,J=l*N,k=V*p,C=l*F,sn=q*p,cn=M*N,on=V*S,rn=M*F,un=q*S,ln=M*p,dn=l*S,pn=y*T,Mn=U*A,En=s*T,Tn=U*i,In=s*A,Rn=y*i,$n=e*T,Nn=U*u,Xn=e*A,Zn=y*u,Yn=e*i,Wn=s*u,jn=Y*i+k*A+C*T-(K*i+J*A+sn*T),Kn=K*u+cn*A+un*T-(Y*u+on*A+rn*T),Jn=J*u+on*i+ln*T-(k*u+cn*i+dn*T),kn=sn*u+rn*i+dn*A-(C*u+un*i+ln*A),an=1/(e*jn+s*Kn+y*Jn+U*kn);return t[0]=an*jn,t[1]=an*Kn,t[2]=an*Jn,t[3]=an*kn,t[4]=an*(K*s+J*y+sn*U-(Y*s+k*y+C*U)),t[5]=an*(Y*e+on*y+rn*U-(K*e+cn*y+un*U)),t[6]=an*(k*e+cn*s+dn*U-(J*e+on*s+ln*U)),t[7]=an*(C*e+un*s+ln*y-(sn*e+rn*s+dn*y)),t[8]=an*(pn*p+Tn*F+In*N-(Mn*p+En*F+Rn*N)),t[9]=an*(Mn*S+$n*F+Zn*N-(pn*S+Nn*F+Xn*N)),t[10]=an*(En*S+Nn*p+Yn*N-(Tn*S+$n*p+Wn*N)),t[11]=an*(Rn*S+Xn*p+Wn*F-(In*S+Zn*p+Yn*F)),t[12]=an*(En*q+Rn*V+Mn*l-(In*V+pn*l+Tn*q)),t[13]=an*(Xn*V+pn*M+Nn*q-($n*q+Zn*V+Mn*M)),t[14]=an*($n*l+Wn*V+Tn*M-(Yn*V+En*M+Nn*l)),t[15]=an*(Yn*q+In*M+Zn*l-(Xn*l+Wn*q+Rn*M)),t}function zn(n){const c=n[0],t=n[0*4+1],e=n[0*4+2],u=n[0*4+3],M=n[1*4+0],S=n[1*4+1],s=n[1*4+2],i=n[1*4+3],l=n[2*4+0],p=n[2*4+1],y=n[2*4+2],A=n[2*4+3],q=n[3*4+0],F=n[3*4+1],U=n[3*4+2],T=n[3*4+3],V=y*T,N=U*A,Y=s*T,K=U*i,J=s*A,k=y*i,C=e*T,sn=U*u,cn=e*A,on=y*u,rn=e*i,un=s*u,ln=V*S+K*p+J*F-(N*S+Y*p+k*F),dn=N*t+C*p+on*F-(V*t+sn*p+cn*F),pn=Y*t+sn*S+rn*F-(K*t+C*S+un*F),Mn=k*t+cn*S+un*p-(J*t+on*S+rn*p);return c*ln+M*dn+l*pn+q*Mn}const An=fn;function Vn(n,c,t){const e=t??new a(16),u=n[0],M=n[1],S=n[2],s=n[3],i=n[4],l=n[5],p=n[6],y=n[7],A=n[8],q=n[9],F=n[10],U=n[11],T=n[12],V=n[13],N=n[14],Y=n[15],K=c[0],J=c[1],k=c[2],C=c[3],sn=c[4],cn=c[5],on=c[6],rn=c[7],un=c[8],ln=c[9],dn=c[10],pn=c[11],Mn=c[12],En=c[13],Tn=c[14],In=c[15];return e[0]=u*K+i*J+A*k+T*C,e[1]=M*K+l*J+q*k+V*C,e[2]=S*K+p*J+F*k+N*C,e[3]=s*K+y*J+U*k+Y*C,e[4]=u*sn+i*cn+A*on+T*rn,e[5]=M*sn+l*cn+q*on+V*rn,e[6]=S*sn+p*cn+F*on+N*rn,e[7]=s*sn+y*cn+U*on+Y*rn,e[8]=u*un+i*ln+A*dn+T*pn,e[9]=M*un+l*ln+q*dn+V*pn,e[10]=S*un+p*ln+F*dn+N*pn,e[11]=s*un+y*ln+U*dn+Y*pn,e[12]=u*Mn+i*En+A*Tn+T*In,e[13]=M*Mn+l*En+q*Tn+V*In,e[14]=S*Mn+p*En+F*Tn+N*In,e[15]=s*Mn+y*En+U*Tn+Y*In,e}const Fn=Vn;function xn(n,c,t){const e=t??en();return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11]),e[12]=c[0],e[13]=c[1],e[14]=c[2],e[15]=1,e}function wn(n,c){const t=c??x.create();return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function vn(n,c,t){const e=t??x.create(),u=c*4;return e[0]=n[u+0],e[1]=n[u+1],e[2]=n[u+2],e}function Sn(n,c,t,e){const u=e===n?e:nn(n,e),M=t*4;return u[M+0]=c[0],u[M+1]=c[1],u[M+2]=c[2],u}function qn(n,c){const t=c??x.create(),e=n[0],u=n[1],M=n[2],S=n[4],s=n[5],i=n[6],l=n[8],p=n[9],y=n[10];return t[0]=Math.sqrt(e*e+u*u+M*M),t[1]=Math.sqrt(S*S+s*s+i*i),t[2]=Math.sqrt(l*l+p*p+y*y),t}function On(n,c,t,e,u){const M=u??new a(16),S=Math.tan(Math.PI*.5-.5*n);if(M[0]=S/c,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=S,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,Number.isFinite(e)){const s=1/(t-e);M[10]=e*s,M[14]=e*t*s}else M[10]=-1,M[14]=-t;return M}function Pn(n,c,t,e=1/0,u){const M=u??new a(16),S=1/Math.tan(n*.5);if(M[0]=S/c,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=S,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,e===1/0)M[10]=0,M[14]=t;else{const s=1/(e-t);M[10]=t*s,M[14]=e*t*s}return M}function Bn(n,c,t,e,u,M,S){const s=S??new a(16);return s[0]=2/(c-n),s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/(e-t),s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1/(u-M),s[11]=0,s[12]=(c+n)/(n-c),s[13]=(e+t)/(t-e),s[14]=u/(u-M),s[15]=1,s}function b(n,c,t,e,u,M,S){const s=S??new a(16),i=c-n,l=e-t,p=u-M;return s[0]=2*u/i,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*u/l,s[6]=0,s[7]=0,s[8]=(n+c)/i,s[9]=(e+t)/l,s[10]=M/p,s[11]=-1,s[12]=0,s[13]=0,s[14]=u*M/p,s[15]=0,s}function Un(n,c,t,e,u,M=1/0,S){const s=S??new a(16),i=c-n,l=e-t;if(s[0]=2*u/i,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*u/l,s[6]=0,s[7]=0,s[8]=(n+c)/i,s[9]=(e+t)/l,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,M===1/0)s[10]=0,s[14]=u;else{const p=1/(M-u);s[10]=u*p,s[14]=M*u*p}return s}const W=x.create(),j=x.create(),Z=x.create();function Ln(n,c,t,e){const u=e??new a(16);return x.normalize(x.subtract(c,n,Z),Z),x.normalize(x.cross(t,Z,W),W),x.normalize(x.cross(Z,W,j),j),u[0]=W[0],u[1]=W[1],u[2]=W[2],u[3]=0,u[4]=j[0],u[5]=j[1],u[6]=j[2],u[7]=0,u[8]=Z[0],u[9]=Z[1],u[10]=Z[2],u[11]=0,u[12]=n[0],u[13]=n[1],u[14]=n[2],u[15]=1,u}function hn(n,c,t,e){const u=e??new a(16);return x.normalize(x.subtract(n,c,Z),Z),x.normalize(x.cross(t,Z,W),W),x.normalize(x.cross(Z,W,j),j),u[0]=W[0],u[1]=W[1],u[2]=W[2],u[3]=0,u[4]=j[0],u[5]=j[1],u[6]=j[2],u[7]=0,u[8]=Z[0],u[9]=Z[1],u[10]=Z[2],u[11]=0,u[12]=n[0],u[13]=n[1],u[14]=n[2],u[15]=1,u}function f(n,c,t,e){const u=e??new a(16);return x.normalize(x.subtract(n,c,Z),Z),x.normalize(x.cross(t,Z,W),W),x.normalize(x.cross(Z,W,j),j),u[0]=W[0],u[1]=j[0],u[2]=Z[0],u[3]=0,u[4]=W[1],u[5]=j[1],u[6]=Z[1],u[7]=0,u[8]=W[2],u[9]=j[2],u[10]=Z[2],u[11]=0,u[12]=-(W[0]*n[0]+W[1]*n[1]+W[2]*n[2]),u[13]=-(j[0]*n[0]+j[1]*n[1]+j[2]*n[2]),u[14]=-(Z[0]*n[0]+Z[1]*n[1]+Z[2]*n[2]),u[15]=1,u}function P(n,c){const t=c??new a(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function D(n,c,t){const e=t??new a(16),u=c[0],M=c[1],S=c[2],s=n[0],i=n[1],l=n[2],p=n[3],y=n[1*4+0],A=n[1*4+1],q=n[1*4+2],F=n[1*4+3],U=n[2*4+0],T=n[2*4+1],V=n[2*4+2],N=n[2*4+3],Y=n[3*4+0],K=n[3*4+1],J=n[3*4+2],k=n[3*4+3];return n!==e&&(e[0]=s,e[1]=i,e[2]=l,e[3]=p,e[4]=y,e[5]=A,e[6]=q,e[7]=F,e[8]=U,e[9]=T,e[10]=V,e[11]=N),e[12]=s*u+y*M+U*S+Y,e[13]=i*u+A*M+T*S+K,e[14]=l*u+q*M+V*S+J,e[15]=p*u+F*M+N*S+k,e}function z(n,c){const t=c??new a(16),e=Math.cos(n),u=Math.sin(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=u,t[7]=0,t[8]=0,t[9]=-u,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function E(n,c,t){const e=t??new a(16),u=n[4],M=n[5],S=n[6],s=n[7],i=n[8],l=n[9],p=n[10],y=n[11],A=Math.cos(c),q=Math.sin(c);return e[4]=A*u+q*i,e[5]=A*M+q*l,e[6]=A*S+q*p,e[7]=A*s+q*y,e[8]=A*i-q*u,e[9]=A*l-q*M,e[10]=A*p-q*S,e[11]=A*y-q*s,n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function I(n,c){const t=c??new a(16),e=Math.cos(n),u=Math.sin(n);return t[0]=e,t[1]=0,t[2]=-u,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=u,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(n,c,t){const e=t??new a(16),u=n[0*4+0],M=n[0*4+1],S=n[0*4+2],s=n[0*4+3],i=n[2*4+0],l=n[2*4+1],p=n[2*4+2],y=n[2*4+3],A=Math.cos(c),q=Math.sin(c);return e[0]=A*u-q*i,e[1]=A*M-q*l,e[2]=A*S-q*p,e[3]=A*s-q*y,e[8]=A*i+q*u,e[9]=A*l+q*M,e[10]=A*p+q*S,e[11]=A*y+q*s,n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function G(n,c){const t=c??new a(16),e=Math.cos(n),u=Math.sin(n);return t[0]=e,t[1]=u,t[2]=0,t[3]=0,t[4]=-u,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function R(n,c,t){const e=t??new a(16),u=n[0*4+0],M=n[0*4+1],S=n[0*4+2],s=n[0*4+3],i=n[1*4+0],l=n[1*4+1],p=n[1*4+2],y=n[1*4+3],A=Math.cos(c),q=Math.sin(c);return e[0]=A*u+q*i,e[1]=A*M+q*l,e[2]=A*S+q*p,e[3]=A*s+q*y,e[4]=A*i-q*u,e[5]=A*l-q*M,e[6]=A*p-q*S,e[7]=A*y-q*s,n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function O(n,c,t){const e=t??new a(16);let u=n[0],M=n[1],S=n[2];const s=Math.sqrt(u*u+M*M+S*S);u/=s,M/=s,S/=s;const i=u*u,l=M*M,p=S*S,y=Math.cos(c),A=Math.sin(c),q=1-y;return e[0]=i+(1-i)*y,e[1]=u*M*q+S*A,e[2]=u*S*q-M*A,e[3]=0,e[4]=u*M*q-S*A,e[5]=l+(1-l)*y,e[6]=M*S*q+u*A,e[7]=0,e[8]=u*S*q+M*A,e[9]=M*S*q-u*A,e[10]=p+(1-p)*y,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}const h=O;function g(n,c,t,e){const u=e??new a(16);let M=c[0],S=c[1],s=c[2];const i=Math.sqrt(M*M+S*S+s*s);M/=i,S/=i,s/=i;const l=M*M,p=S*S,y=s*s,A=Math.cos(t),q=Math.sin(t),F=1-A,U=l+(1-l)*A,T=M*S*F+s*q,V=M*s*F-S*q,N=M*S*F-s*q,Y=p+(1-p)*A,K=S*s*F+M*q,J=M*s*F+S*q,k=S*s*F-M*q,C=y+(1-y)*A,sn=n[0],cn=n[1],on=n[2],rn=n[3],un=n[4],ln=n[5],dn=n[6],pn=n[7],Mn=n[8],En=n[9],Tn=n[10],In=n[11];return u[0]=U*sn+T*un+V*Mn,u[1]=U*cn+T*ln+V*En,u[2]=U*on+T*dn+V*Tn,u[3]=U*rn+T*pn+V*In,u[4]=N*sn+Y*un+K*Mn,u[5]=N*cn+Y*ln+K*En,u[6]=N*on+Y*dn+K*Tn,u[7]=N*rn+Y*pn+K*In,u[8]=J*sn+k*un+C*Mn,u[9]=J*cn+k*ln+C*En,u[10]=J*on+k*dn+C*Tn,u[11]=J*rn+k*pn+C*In,n!==u&&(u[12]=n[12],u[13]=n[13],u[14]=n[14],u[15]=n[15]),u}const o=g;function r(n,c){const t=c??new a(16);return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w(n,c,t){const e=t??new a(16),u=c[0],M=c[1],S=c[2];return e[0]=u*n[0*4+0],e[1]=u*n[0*4+1],e[2]=u*n[0*4+2],e[3]=u*n[0*4+3],e[4]=M*n[1*4+0],e[5]=M*n[1*4+1],e[6]=M*n[1*4+2],e[7]=M*n[1*4+3],e[8]=S*n[2*4+0],e[9]=S*n[2*4+1],e[10]=S*n[2*4+2],e[11]=S*n[2*4+3],n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function d(n,c){const t=c??new a(16);return t[0]=n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function B(n,c,t){const e=t??new a(16);return e[0]=c*n[0*4+0],e[1]=c*n[0*4+1],e[2]=c*n[0*4+2],e[3]=c*n[0*4+3],e[4]=c*n[1*4+0],e[5]=c*n[1*4+1],e[6]=c*n[1*4+2],e[7]=c*n[1*4+3],e[8]=c*n[2*4+0],e[9]=c*n[2*4+1],e[10]=c*n[2*4+2],e[11]=c*n[2*4+3],n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}return{create:v,set:_,fromMat3:X,fromQuat:Q,negate:m,copy:nn,clone:tn,equalsApproximately:gn,equals:Dn,identity:en,transpose:yn,inverse:fn,determinant:zn,invert:An,multiply:Vn,mul:Fn,setTranslation:xn,getTranslation:wn,getAxis:vn,setAxis:Sn,getScaling:qn,perspective:On,perspectiveReverseZ:Pn,ortho:Bn,frustum:b,frustumReverseZ:Un,aim:Ln,cameraAim:hn,lookAt:f,translation:P,translate:D,rotationX:z,rotateX:E,rotationY:I,rotateY:L,rotationZ:G,rotateZ:R,axisRotation:O,rotation:h,axisRotate:g,rotate:o,scaling:r,scale:w,uniformScaling:d,uniformScale:B}}const nt=new Map;function lt(a){let x=nt.get(a);return x||(x=ht(a),nt.set(a,x)),x}function dt(a){const x=Hn(a);function v(h,g,o,r){const w=new a(4);return h!==void 0&&(w[0]=h,g!==void 0&&(w[1]=g,o!==void 0&&(w[2]=o,r!==void 0&&(w[3]=r)))),w}const _=v;function X(h,g,o,r,w){const d=w??new a(4);return d[0]=h,d[1]=g,d[2]=o,d[3]=r,d}function Q(h,g,o){const r=o??new a(4),w=g*.5,d=Math.sin(w);return r[0]=d*h[0],r[1]=d*h[1],r[2]=d*h[2],r[3]=Math.cos(w),r}function m(h,g){const o=g??x.create(3),r=Math.acos(h[3])*2,w=Math.sin(r*.5);return w>$?(o[0]=h[0]/w,o[1]=h[1]/w,o[2]=h[2]/w):(o[0]=1,o[1]=0,o[2]=0),{angle:r,axis:o}}function nn(h,g){const o=b(h,g);return Math.acos(2*o*o-1)}function tn(h,g,o){const r=o??new a(4),w=h[0],d=h[1],B=h[2],n=h[3],c=g[0],t=g[1],e=g[2],u=g[3];return r[0]=w*u+n*c+d*e-B*t,r[1]=d*u+n*t+B*c-w*e,r[2]=B*u+n*e+w*t-d*c,r[3]=n*u-w*c-d*t-B*e,r}const gn=tn;function Dn(h,g,o){const r=o??new a(4),w=g*.5,d=h[0],B=h[1],n=h[2],c=h[3],t=Math.sin(w),e=Math.cos(w);return r[0]=d*e+c*t,r[1]=B*e+n*t,r[2]=n*e-B*t,r[3]=c*e-d*t,r}function en(h,g,o){const r=o??new a(4),w=g*.5,d=h[0],B=h[1],n=h[2],c=h[3],t=Math.sin(w),e=Math.cos(w);return r[0]=d*e-n*t,r[1]=B*e+c*t,r[2]=n*e+d*t,r[3]=c*e-B*t,r}function yn(h,g,o){const r=o??new a(4),w=g*.5,d=h[0],B=h[1],n=h[2],c=h[3],t=Math.sin(w),e=Math.cos(w);return r[0]=d*e+B*t,r[1]=B*e-d*t,r[2]=n*e+c*t,r[3]=c*e-n*t,r}function fn(h,g,o,r){const w=r??new a(4),d=h[0],B=h[1],n=h[2],c=h[3];let t=g[0],e=g[1],u=g[2],M=g[3],S=d*t+B*e+n*u+c*M;S<0&&(S=-S,t=-t,e=-e,u=-u,M=-M);let s,i;if(1-S>$){const l=Math.acos(S),p=Math.sin(l);s=Math.sin((1-o)*l)/p,i=Math.sin(o*l)/p}else s=1-o,i=o;return w[0]=s*d+i*t,w[1]=s*B+i*e,w[2]=s*n+i*u,w[3]=s*c+i*M,w}function zn(h,g){const o=g??new a(4),r=h[0],w=h[1],d=h[2],B=h[3],n=r*r+w*w+d*d+B*B,c=n?1/n:0;return o[0]=-r*c,o[1]=-w*c,o[2]=-d*c,o[3]=B*c,o}function An(h,g){const o=g??new a(4);return o[0]=-h[0],o[1]=-h[1],o[2]=-h[2],o[3]=h[3],o}function Vn(h,g){const o=g??new a(4),r=h[0]+h[5]+h[10];if(r>0){const w=Math.sqrt(r+1);o[3]=.5*w;const d=.5/w;o[0]=(h[6]-h[9])*d,o[1]=(h[8]-h[2])*d,o[2]=(h[1]-h[4])*d}else{let w=0;h[5]>h[0]&&(w=1),h[10]>h[w*4+w]&&(w=2);const d=(w+1)%3,B=(w+2)%3,n=Math.sqrt(h[w*4+w]-h[d*4+d]-h[B*4+B]+1);o[w]=.5*n;const c=.5/n;o[3]=(h[d*4+B]-h[B*4+d])*c,o[d]=(h[d*4+w]+h[w*4+d])*c,o[B]=(h[B*4+w]+h[w*4+B])*c}return o}function Fn(h,g,o,r,w){const d=w??new a(4),B=h*.5,n=g*.5,c=o*.5,t=Math.sin(B),e=Math.cos(B),u=Math.sin(n),M=Math.cos(n),S=Math.sin(c),s=Math.cos(c);switch(r){case"xyz":d[0]=t*M*s+e*u*S,d[1]=e*u*s-t*M*S,d[2]=e*M*S+t*u*s,d[3]=e*M*s-t*u*S;break;case"xzy":d[0]=t*M*s-e*u*S,d[1]=e*u*s-t*M*S,d[2]=e*M*S+t*u*s,d[3]=e*M*s+t*u*S;break;case"yxz":d[0]=t*M*s+e*u*S,d[1]=e*u*s-t*M*S,d[2]=e*M*S-t*u*s,d[3]=e*M*s+t*u*S;break;case"yzx":d[0]=t*M*s+e*u*S,d[1]=e*u*s+t*M*S,d[2]=e*M*S-t*u*s,d[3]=e*M*s-t*u*S;break;case"zxy":d[0]=t*M*s-e*u*S,d[1]=e*u*s+t*M*S,d[2]=e*M*S+t*u*s,d[3]=e*M*s-t*u*S;break;case"zyx":d[0]=t*M*s-e*u*S,d[1]=e*u*s+t*M*S,d[2]=e*M*S-t*u*s,d[3]=e*M*s+t*u*S;break;default:throw new Error(`Unknown rotation order: ${r}`)}return d}function xn(h,g){const o=g??new a(4);return o[0]=h[0],o[1]=h[1],o[2]=h[2],o[3]=h[3],o}const wn=xn;function vn(h,g,o){const r=o??new a(4);return r[0]=h[0]+g[0],r[1]=h[1]+g[1],r[2]=h[2]+g[2],r[3]=h[3]+g[3],r}function Sn(h,g,o){const r=o??new a(4);return r[0]=h[0]-g[0],r[1]=h[1]-g[1],r[2]=h[2]-g[2],r[3]=h[3]-g[3],r}const qn=Sn;function On(h,g,o){const r=o??new a(4);return r[0]=h[0]*g,r[1]=h[1]*g,r[2]=h[2]*g,r[3]=h[3]*g,r}const Pn=On;function Bn(h,g,o){const r=o??new a(4);return r[0]=h[0]/g,r[1]=h[1]/g,r[2]=h[2]/g,r[3]=h[3]/g,r}function b(h,g){return h[0]*g[0]+h[1]*g[1]+h[2]*g[2]+h[3]*g[3]}function Un(h,g,o,r){const w=r??new a(4);return w[0]=h[0]+o*(g[0]-h[0]),w[1]=h[1]+o*(g[1]-h[1]),w[2]=h[2]+o*(g[2]-h[2]),w[3]=h[3]+o*(g[3]-h[3]),w}function W(h){const g=h[0],o=h[1],r=h[2],w=h[3];return Math.sqrt(g*g+o*o+r*r+w*w)}const j=W;function Z(h){const g=h[0],o=h[1],r=h[2],w=h[3];return g*g+o*o+r*r+w*w}const Ln=Z;function hn(h,g){const o=g??new a(4),r=h[0],w=h[1],d=h[2],B=h[3],n=Math.sqrt(r*r+w*w+d*d+B*B);return n>1e-5?(o[0]=r/n,o[1]=w/n,o[2]=d/n,o[3]=B/n):(o[0]=0,o[1]=0,o[2]=0,o[3]=1),o}function f(h,g){return Math.abs(h[0]-g[0])<$&&Math.abs(h[1]-g[1])<$&&Math.abs(h[2]-g[2])<$&&Math.abs(h[3]-g[3])<$}function P(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]}function D(h){const g=h??new a(4);return g[0]=0,g[1]=0,g[2]=0,g[3]=1,g}const z=x.create(),E=x.create(),I=x.create();function L(h,g,o){const r=o??new a(4),w=x.dot(h,g);return w<-.999999?(x.cross(E,h,z),x.len(z)<1e-6&&x.cross(I,h,z),x.normalize(z,z),Q(z,Math.PI,r),r):w>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(x.cross(h,g,z),r[0]=z[0],r[1]=z[1],r[2]=z[2],r[3]=1+w,hn(r,r))}const G=new a(4),R=new a(4);function O(h,g,o,r,w,d){const B=d??new a(4);return fn(h,r,w,G),fn(g,o,w,R),fn(G,R,2*w*(1-w),B),B}return{create:v,fromValues:_,set:X,fromAxisAngle:Q,toAxisAngle:m,angle:nn,multiply:tn,mul:gn,rotateX:Dn,rotateY:en,rotateZ:yn,slerp:fn,inverse:zn,conjugate:An,fromMat:Vn,fromEuler:Fn,copy:xn,clone:wn,add:vn,subtract:Sn,sub:qn,mulScalar:On,scale:Pn,divScalar:Bn,dot:b,lerp:Un,length:W,len:j,lengthSq:Z,lenSq:Ln,normalize:hn,equalsApproximately:f,equals:P,identity:D,rotationTo:L,sqlerp:O}}const tt=new Map;function pt(a){let x=tt.get(a);return x||(x=dt(a),tt.set(a,x)),x}function Mt(a){function x(o,r,w,d){const B=new a(4);return o!==void 0&&(B[0]=o,r!==void 0&&(B[1]=r,w!==void 0&&(B[2]=w,d!==void 0&&(B[3]=d)))),B}const v=x;function _(o,r,w,d,B){const n=B??new a(4);return n[0]=o,n[1]=r,n[2]=w,n[3]=d,n}function X(o,r){const w=r??new a(4);return w[0]=Math.ceil(o[0]),w[1]=Math.ceil(o[1]),w[2]=Math.ceil(o[2]),w[3]=Math.ceil(o[3]),w}function Q(o,r){const w=r??new a(4);return w[0]=Math.floor(o[0]),w[1]=Math.floor(o[1]),w[2]=Math.floor(o[2]),w[3]=Math.floor(o[3]),w}function m(o,r){const w=r??new a(4);return w[0]=Math.round(o[0]),w[1]=Math.round(o[1]),w[2]=Math.round(o[2]),w[3]=Math.round(o[3]),w}function nn(o,r=0,w=1,d){const B=d??new a(4);return B[0]=Math.min(w,Math.max(r,o[0])),B[1]=Math.min(w,Math.max(r,o[1])),B[2]=Math.min(w,Math.max(r,o[2])),B[3]=Math.min(w,Math.max(r,o[3])),B}function tn(o,r,w){const d=w??new a(4);return d[0]=o[0]+r[0],d[1]=o[1]+r[1],d[2]=o[2]+r[2],d[3]=o[3]+r[3],d}function gn(o,r,w,d){const B=d??new a(4);return B[0]=o[0]+r[0]*w,B[1]=o[1]+r[1]*w,B[2]=o[2]+r[2]*w,B[3]=o[3]+r[3]*w,B}function Dn(o,r,w){const d=w??new a(4);return d[0]=o[0]-r[0],d[1]=o[1]-r[1],d[2]=o[2]-r[2],d[3]=o[3]-r[3],d}const en=Dn;function yn(o,r){return Math.abs(o[0]-r[0])<$&&Math.abs(o[1]-r[1])<$&&Math.abs(o[2]-r[2])<$&&Math.abs(o[3]-r[3])<$}function fn(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]}function zn(o,r,w,d){const B=d??new a(4);return B[0]=o[0]+w*(r[0]-o[0]),B[1]=o[1]+w*(r[1]-o[1]),B[2]=o[2]+w*(r[2]-o[2]),B[3]=o[3]+w*(r[3]-o[3]),B}function An(o,r,w,d){const B=d??new a(4);return B[0]=o[0]+w[0]*(r[0]-o[0]),B[1]=o[1]+w[1]*(r[1]-o[1]),B[2]=o[2]+w[2]*(r[2]-o[2]),B[3]=o[3]+w[3]*(r[3]-o[3]),B}function Vn(o,r,w){const d=w??new a(4);return d[0]=Math.max(o[0],r[0]),d[1]=Math.max(o[1],r[1]),d[2]=Math.max(o[2],r[2]),d[3]=Math.max(o[3],r[3]),d}function Fn(o,r,w){const d=w??new a(4);return d[0]=Math.min(o[0],r[0]),d[1]=Math.min(o[1],r[1]),d[2]=Math.min(o[2],r[2]),d[3]=Math.min(o[3],r[3]),d}function xn(o,r,w){const d=w??new a(4);return d[0]=o[0]*r,d[1]=o[1]*r,d[2]=o[2]*r,d[3]=o[3]*r,d}const wn=xn;function vn(o,r,w){const d=w??new a(4);return d[0]=o[0]/r,d[1]=o[1]/r,d[2]=o[2]/r,d[3]=o[3]/r,d}function Sn(o,r){const w=r??new a(4);return w[0]=1/o[0],w[1]=1/o[1],w[2]=1/o[2],w[3]=1/o[3],w}const qn=Sn;function On(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]+o[3]*r[3]}function Pn(o){const r=o[0],w=o[1],d=o[2],B=o[3];return Math.sqrt(r*r+w*w+d*d+B*B)}const Bn=Pn;function b(o){const r=o[0],w=o[1],d=o[2],B=o[3];return r*r+w*w+d*d+B*B}const Un=b;function W(o,r){const w=o[0]-r[0],d=o[1]-r[1],B=o[2]-r[2],n=o[3]-r[3];return Math.sqrt(w*w+d*d+B*B+n*n)}const j=W;function Z(o,r){const w=o[0]-r[0],d=o[1]-r[1],B=o[2]-r[2],n=o[3]-r[3];return w*w+d*d+B*B+n*n}const Ln=Z;function hn(o,r){const w=r??new a(4),d=o[0],B=o[1],n=o[2],c=o[3],t=Math.sqrt(d*d+B*B+n*n+c*c);return t>1e-5?(w[0]=d/t,w[1]=B/t,w[2]=n/t,w[3]=c/t):(w[0]=0,w[1]=0,w[2]=0,w[3]=0),w}function f(o,r){const w=r??new a(4);return w[0]=-o[0],w[1]=-o[1],w[2]=-o[2],w[3]=-o[3],w}function P(o,r){const w=r??new a(4);return w[0]=o[0],w[1]=o[1],w[2]=o[2],w[3]=o[3],w}const D=P;function z(o,r,w){const d=w??new a(4);return d[0]=o[0]*r[0],d[1]=o[1]*r[1],d[2]=o[2]*r[2],d[3]=o[3]*r[3],d}const E=z;function I(o,r,w){const d=w??new a(4);return d[0]=o[0]/r[0],d[1]=o[1]/r[1],d[2]=o[2]/r[2],d[3]=o[3]/r[3],d}const L=I;function G(o){const r=o??new a(4);return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r}function R(o,r,w){const d=w??new a(4),B=o[0],n=o[1],c=o[2],t=o[3];return d[0]=r[0]*B+r[4]*n+r[8]*c+r[12]*t,d[1]=r[1]*B+r[5]*n+r[9]*c+r[13]*t,d[2]=r[2]*B+r[6]*n+r[10]*c+r[14]*t,d[3]=r[3]*B+r[7]*n+r[11]*c+r[15]*t,d}function O(o,r,w){const d=w??new a(4);return hn(o,d),xn(d,r,d)}function h(o,r,w){const d=w??new a(4);return Pn(o)>r?O(o,r,d):P(o,d)}function g(o,r,w){const d=w??new a(4);return zn(o,r,.5,d)}return{create:x,fromValues:v,set:_,ceil:X,floor:Q,round:m,clamp:nn,add:tn,addScaled:gn,subtract:Dn,sub:en,equalsApproximately:yn,equals:fn,lerp:zn,lerpV:An,max:Vn,min:Fn,mulScalar:xn,scale:wn,divScalar:vn,inverse:Sn,invert:qn,dot:On,length:Pn,len:Bn,lengthSq:b,lenSq:Un,distance:W,dist:j,distanceSq:Z,distSq:Ln,normalize:hn,negate:f,copy:P,clone:D,multiply:z,mul:E,divide:I,div:L,zero:G,transformMat4:R,setLength:O,truncate:h,midpoint:g}}const et=new Map;function Dt(a){let x=et.get(a);return x||(x=Mt(a),et.set(a,x)),x}function _n(a,x,v,_,X,Q){return{mat3:wt(a),mat4:lt(x),quat:pt(v),vec2:st(_),vec3:Hn(X),vec4:Dt(Q)}}const{mat3:Pt,mat4:Gn,quat:Bt,vec2:Et,vec3:Qn,vec4:Tt}=_n(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array);_n(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array);_n(it,Array,Array,Array,Array,Array);const yt=new Float32Array([1,-1,0,-1,-1,0,0,1,0]),xt=new Float32Array([1,0,0,1,0,1,0,1,0,0,1,1]),gt=new Uint16Array([0,1,2,0]);class zt{constructor(x){H(this,"canvas");H(this,"device");H(this,"queue");H(this,"presentationContext");H(this,"presentationSize");H(this,"presentationFormat");H(this,"positionBuffer");H(this,"colorBuffer");H(this,"indexBuffer");H(this,"uniformBuffer");H(this,"vertexModule");H(this,"fragmentModule");H(this,"renderTarget");H(this,"renderTargetView");H(this,"depthTarget");H(this,"depthTargetView");H(this,"renderPipeline");H(this,"commandEncoder");H(this,"passEncoder");H(this,"modelMatrix",Gn.identity());H(this,"viewMatrix",Gn.identity());H(this,"perspectiveMatrix",Gn.identity());H(this,"eye",Qn.create(0,0,5));H(this,"zNear",.1);H(this,"zFar",1e3);H(this,"sampleCount",4);H(this,"uniformBindGroup");H(this,"onMouseWheel",x=>{let v=this.eye[2]+=x.deltaY*.01;v=Math.max(this.zNear,Math.min(this.zFar,v)),this.eye[2]=v});H(this,"render",()=>{const x=.5*Math.PI/180;Gn.rotateZ(this.modelMatrix,x,this.modelMatrix),this.updateUniformBuffer(),this.encodeCommands(),requestAnimationFrame(this.render)});this.canvas=x,this.updateViewMatrix(),this.updatePerspectiveMatrix()}updatePerspectiveMatrix(){const x=this.canvas.width/this.canvas.height,v=45*Math.PI/180;this.perspectiveMatrix=Gn.perspective(v,x,this.zNear,this.zFar)}updateViewMatrix(){const x=Qn.create(0,0,0),v=Qn.create(0,1,0);this.viewMatrix=Gn.lookAt(this.eye,x,v)}resize(x,v){(x!==this.presentationSize.width||v!==this.presentationSize.height)&&(this.canvas.width=x,this.canvas.height=v,this.presentationSize={width:x,height:v,depthOrArrayLayers:1},this.updatePerspectiveMatrix(),this.resizeSwapchain())}async initialize(){const x=navigator.gpu;if(!x)return console.error("No WebGPU support navigator.gpu not available!"),!1;const v=await x.requestAdapter();return console.log(v.limits),this.device=await v.requestDevice(),this.queue=this.device.queue,this.canvas.style.display="block",this.canvas.addEventListener("wheel",this.onMouseWheel),this.presentationSize={width:this.canvas.width,height:this.canvas.height,depthOrArrayLayers:1},this.presentationContext=this.canvas.getContext("webgpu"),this.presentationFormat=x.getPreferredCanvasFormat(),this.presentationContext.configure({device:this.device,format:this.presentationFormat,alphaMode:"opaque"}),new ResizeObserver(X=>{Array.isArray(X)&&this.resize(X[0].contentRect.width*window.devicePixelRatio,X[0].contentRect.height*window.devicePixelRatio)}).observe(this.canvas),!0}createBuffer(x,v){try{const _=this.device.createBuffer({mappedAtCreation:!0,size:x.byteLength,usage:v}),X=_.getMappedRange();return(x instanceof Float32Array?new Float32Array(X):new Uint16Array(X)).set(x),_.unmap(),_}catch(_){console.error(_)}}createUBOArray(){const x=new Float32Array(48);return x.set(this.modelMatrix),x.set(this.viewMatrix,16),x.set(this.perspectiveMatrix,32),x}updateUniformBuffer(){this.updateViewMatrix();const x=this.createUBOArray();this.queue.writeBuffer(this.uniformBuffer,0,x.buffer)}async loadShader(x){const v=await fetch(x);return this.device.createShaderModule({code:await v.text()})}resizeSwapchain(){this.renderTarget!==void 0&&(this.renderTarget.destroy(),this.depthTarget.destroy()),this.renderTarget=this.device.createTexture({size:this.presentationSize,sampleCount:this.sampleCount,format:this.presentationFormat,usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.renderTargetView=this.renderTarget.createView(),this.depthTarget=this.device.createTexture({size:this.presentationSize,sampleCount:this.sampleCount,format:"depth24plus-stencil8",usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.depthTargetView=this.depthTarget.createView()}encodeCommands(){const x={view:this.presentationContext.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"};this.sampleCount>1&&(x.view=this.renderTargetView,x.resolveTarget=this.presentationContext.getCurrentTexture().createView());const v={view:this.depthTargetView,depthLoadOp:"clear",depthClearValue:1,depthStoreOp:"store",stencilLoadOp:"clear",stencilClearValue:0,stencilStoreOp:"store"},_={colorAttachments:[x],depthStencilAttachment:v};this.commandEncoder=this.device.createCommandEncoder(),this.passEncoder=this.commandEncoder.beginRenderPass(_),this.passEncoder.setPipeline(this.renderPipeline),this.passEncoder.setBindGroup(0,this.uniformBindGroup),this.passEncoder.setViewport(0,0,this.canvas.width,this.canvas.height,0,1),this.passEncoder.setScissorRect(0,0,this.canvas.width,this.canvas.height),this.passEncoder.setVertexBuffer(0,this.positionBuffer),this.passEncoder.setVertexBuffer(1,this.colorBuffer),this.passEncoder.setIndexBuffer(this.indexBuffer,"uint16"),this.passEncoder.drawIndexed(3,1,0,0,0),this.passEncoder.end(),this.queue.submit([this.commandEncoder.finish()])}async initializeResources(){this.positionBuffer=this.createBuffer(yt,GPUBufferUsage.VERTEX),this.colorBuffer=this.createBuffer(xt,GPUBufferUsage.VERTEX),this.indexBuffer=this.createBuffer(gt,GPUBufferUsage.INDEX);const x=this.createUBOArray();this.uniformBuffer=this.createBuffer(x,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),this.vertexModule=await this.loadShader("./shaders/basic.vert.wgsl"),this.fragmentModule=await this.loadShader("./shaders/basic.frag.wgsl");const v={shaderLocation:0,offset:0,format:"float32x3"},_={shaderLocation:1,offset:0,format:"float32x4"},X={attributes:[v],arrayStride:4*3,stepMode:"vertex"},Q={attributes:[_],arrayStride:4*4,stepMode:"vertex"},m={depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus-stencil8"},nn=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}}]});this.uniformBindGroup=this.device.createBindGroup({layout:nn,entries:[{binding:0,resource:{buffer:this.uniformBuffer}}]});const tn=this.device.createPipelineLayout({bindGroupLayouts:[nn]}),gn={module:this.vertexModule,entryPoint:"main",buffers:[X,Q]},Dn={format:"bgra8unorm",blend:{alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}},writeMask:GPUColorWrite.ALL},en={module:this.fragmentModule,entryPoint:"main",targets:[Dn]},yn={layout:tn,vertex:gn,fragment:en,primitive:{topology:"triangle-list",frontFace:"cw",cullMode:"none"},depthStencil:m,multisample:{count:this.sampleCount}};this.renderPipeline=this.device.createRenderPipeline(yn)}async start(){if(await this.initialize())this.resizeSwapchain(),await this.initializeResources(),this.render();else{const x=document.getElementById("error");x.style.display="block"}}}const At=document.getElementById("webgpu_canvas"),St=new zt(At);St.start();
