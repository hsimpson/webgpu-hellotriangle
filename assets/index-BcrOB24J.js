var ct=Object.defineProperty;var ot=(a,x,U)=>x in a?ct(a,x,{enumerable:!0,configurable:!0,writable:!0,value:U}):a[x]=U;var _=(a,x,U)=>ot(a,typeof x!="symbol"?x+"":x,U);(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const X of document.querySelectorAll('link[rel="modulepreload"]'))K(X);new MutationObserver(X=>{for(const j of X)if(j.type==="childList")for(const nn of j.addedNodes)nn.tagName==="LINK"&&nn.rel==="modulepreload"&&K(nn)}).observe(document,{childList:!0,subtree:!0});function U(X){const j={};return X.integrity&&(j.integrity=X.integrity),X.referrerPolicy&&(j.referrerPolicy=X.referrerPolicy),X.crossOrigin==="use-credentials"?j.credentials="include":X.crossOrigin==="anonymous"?j.credentials="omit":j.credentials="same-origin",j}function K(X){if(X.ep)return;X.ep=!0;const j=U(X);fetch(X.href,j)}})();function rt(a,x){return class extends a{constructor(...U){super(...U),x(this)}}}const it=rt(Array,a=>a.fill(0));let $=1e-6;function ut(a){function x(n=0,c=0){const t=new a(2);return n!==void 0&&(t[0]=n,c!==void 0&&(t[1]=c)),t}const U=x;function K(n,c,t){const e=t??new a(2);return e[0]=n,e[1]=c,e}function X(n,c){const t=c??new a(2);return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function j(n,c){const t=c??new a(2);return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function nn(n,c){const t=c??new a(2);return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function C(n,c=0,t=1,e){const u=e??new a(2);return u[0]=Math.min(t,Math.max(c,n[0])),u[1]=Math.min(t,Math.max(c,n[1])),u}function Dn(n,c,t){const e=t??new a(2);return e[0]=n[0]+c[0],e[1]=n[1]+c[1],e}function gn(n,c,t,e){const u=e??new a(2);return u[0]=n[0]+c[0]*t,u[1]=n[1]+c[1]*t,u}function yn(n,c){const t=n[0],e=n[1],u=c[0],p=c[1],z=Math.sqrt(t*t+e*e),s=Math.sqrt(u*u+p*p),i=z*s,h=i&&En(n,c)/i;return Math.acos(h)}function tn(n,c,t){const e=t??new a(2);return e[0]=n[0]-c[0],e[1]=n[1]-c[1],e}const zn=tn;function cn(n,c){return Math.abs(n[0]-c[0])<$&&Math.abs(n[1]-c[1])<$}function Fn(n,c){return n[0]===c[0]&&n[1]===c[1]}function An(n,c,t,e){const u=e??new a(2);return u[0]=n[0]+t*(c[0]-n[0]),u[1]=n[1]+t*(c[1]-n[1]),u}function Sn(n,c,t,e){const u=e??new a(2);return u[0]=n[0]+t[0]*(c[0]-n[0]),u[1]=n[1]+t[1]*(c[1]-n[1]),u}function vn(n,c,t){const e=t??new a(2);return e[0]=Math.max(n[0],c[0]),e[1]=Math.max(n[1],c[1]),e}function xn(n,c,t){const e=t??new a(2);return e[0]=Math.min(n[0],c[0]),e[1]=Math.min(n[1],c[1]),e}function hn(n,c,t){const e=t??new a(2);return e[0]=n[0]*c,e[1]=n[1]*c,e}const Un=hn;function Pn(n,c,t){const e=t??new a(2);return e[0]=n[0]/c,e[1]=n[1]/c,e}function qn(n,c){const t=c??new a(2);return t[0]=1/n[0],t[1]=1/n[1],t}const On=qn;function Bn(n,c,t){const e=t??new a(3),u=n[0]*c[1]-n[1]*c[0];return e[0]=0,e[1]=0,e[2]=u,e}function En(n,c){return n[0]*c[0]+n[1]*c[1]}function en(n){const c=n[0],t=n[1];return Math.sqrt(c*c+t*t)}const Ln=en;function H(n){const c=n[0],t=n[1];return c*c+t*t}const J=H;function Z(n,c){const t=n[0]-c[0],e=n[1]-c[1];return Math.sqrt(t*t+e*e)}const w=Z;function q(n,c){const t=n[0]-c[0],e=n[1]-c[1];return t*t+e*e}const D=q;function S(n,c){const t=c??new a(2),e=n[0],u=n[1],p=Math.sqrt(e*e+u*u);return p>1e-5?(t[0]=e/p,t[1]=u/p):(t[0]=0,t[1]=0),t}function V(n,c){const t=c??new a(2);return t[0]=-n[0],t[1]=-n[1],t}function E(n,c){const t=c??new a(2);return t[0]=n[0],t[1]=n[1],t}const G=E;function R(n,c,t){const e=t??new a(2);return e[0]=n[0]*c[0],e[1]=n[1]*c[1],e}const Y=R;function O(n,c,t){const e=t??new a(2);return e[0]=n[0]/c[0],e[1]=n[1]/c[1],e}const v=O;function Q(n=1,c){const t=c??new a(2),e=Math.random()*2*Math.PI;return t[0]=Math.cos(e)*n,t[1]=Math.sin(e)*n,t}function M(n){const c=n??new a(2);return c[0]=0,c[1]=0,c}function P(n,c,t){const e=t??new a(2),u=n[0],p=n[1];return e[0]=u*c[0]+p*c[4]+c[12],e[1]=u*c[1]+p*c[5]+c[13],e}function o(n,c,t){const e=t??new a(2),u=n[0],p=n[1];return e[0]=c[0]*u+c[4]*p+c[8],e[1]=c[1]*u+c[5]*p+c[9],e}function r(n,c,t,e){const u=e??new a(2),p=n[0]-c[0],z=n[1]-c[1],s=Math.sin(t),i=Math.cos(t);return u[0]=p*i-z*s+c[0],u[1]=p*s+z*i+c[1],u}function f(n,c,t){const e=t??new a(2);return S(n,e),hn(e,c,e)}function d(n,c,t){const e=t??new a(2);return en(n)>c?f(n,c,e):E(n,e)}function B(n,c,t){const e=t??new a(2);return An(n,c,.5,e)}return{create:x,fromValues:U,set:K,ceil:X,floor:j,round:nn,clamp:C,add:Dn,addScaled:gn,angle:yn,subtract:tn,sub:zn,equalsApproximately:cn,equals:Fn,lerp:An,lerpV:Sn,max:vn,min:xn,mulScalar:hn,scale:Un,divScalar:Pn,inverse:qn,invert:On,cross:Bn,dot:En,length:en,len:Ln,lengthSq:H,lenSq:J,distance:Z,dist:w,distanceSq:q,distSq:D,normalize:S,negate:V,copy:E,clone:G,multiply:R,mul:Y,divide:O,div:v,random:Q,zero:M,transformMat4:P,transformMat3:o,rotate:r,setLength:f,truncate:d,midpoint:B}}const mn=new Map;function st(a){let x=mn.get(a);return x||(x=ut(a),mn.set(a,x)),x}function at(a){const x=st(a);function U(w,q,D,S,V,E,G,R,Y){const O=new a(12);return O[3]=0,O[7]=0,O[11]=0,w!==void 0&&(O[0]=w,q!==void 0&&(O[1]=q,D!==void 0&&(O[2]=D,S!==void 0&&(O[4]=S,V!==void 0&&(O[5]=V,E!==void 0&&(O[6]=E,G!==void 0&&(O[8]=G,R!==void 0&&(O[9]=R,Y!==void 0&&(O[10]=Y))))))))),O}function K(w,q,D,S,V,E,G,R,Y,O){const v=O??new a(12);return v[0]=w,v[1]=q,v[2]=D,v[3]=0,v[4]=S,v[5]=V,v[6]=E,v[7]=0,v[8]=G,v[9]=R,v[10]=Y,v[11]=0,v}function X(w,q){const D=q??new a(12);return D[0]=w[0],D[1]=w[1],D[2]=w[2],D[3]=0,D[4]=w[4],D[5]=w[5],D[6]=w[6],D[7]=0,D[8]=w[8],D[9]=w[9],D[10]=w[10],D[11]=0,D}function j(w,q){const D=q??new a(12),S=w[0],V=w[1],E=w[2],G=w[3],R=S+S,Y=V+V,O=E+E,v=S*R,Q=V*R,M=V*Y,P=E*R,o=E*Y,r=E*O,f=G*R,d=G*Y,B=G*O;return D[0]=1-M-r,D[1]=Q+B,D[2]=P-d,D[3]=0,D[4]=Q-B,D[5]=1-v-r,D[6]=o+f,D[7]=0,D[8]=P+d,D[9]=o-f,D[10]=1-v-M,D[11]=0,D}function nn(w,q){const D=q??new a(12);return D[0]=-w[0],D[1]=-w[1],D[2]=-w[2],D[4]=-w[4],D[5]=-w[5],D[6]=-w[6],D[8]=-w[8],D[9]=-w[9],D[10]=-w[10],D}function C(w,q){const D=q??new a(12);return D[0]=w[0],D[1]=w[1],D[2]=w[2],D[4]=w[4],D[5]=w[5],D[6]=w[6],D[8]=w[8],D[9]=w[9],D[10]=w[10],D}const Dn=C;function gn(w,q){return Math.abs(w[0]-q[0])<$&&Math.abs(w[1]-q[1])<$&&Math.abs(w[2]-q[2])<$&&Math.abs(w[4]-q[4])<$&&Math.abs(w[5]-q[5])<$&&Math.abs(w[6]-q[6])<$&&Math.abs(w[8]-q[8])<$&&Math.abs(w[9]-q[9])<$&&Math.abs(w[10]-q[10])<$}function yn(w,q){return w[0]===q[0]&&w[1]===q[1]&&w[2]===q[2]&&w[4]===q[4]&&w[5]===q[5]&&w[6]===q[6]&&w[8]===q[8]&&w[9]===q[9]&&w[10]===q[10]}function tn(w){const q=w??new a(12);return q[0]=1,q[1]=0,q[2]=0,q[4]=0,q[5]=1,q[6]=0,q[8]=0,q[9]=0,q[10]=1,q}function zn(w,q){const D=q??new a(12);if(D===w){let M;return M=w[1],w[1]=w[4],w[4]=M,M=w[2],w[2]=w[8],w[8]=M,M=w[6],w[6]=w[9],w[9]=M,D}const S=w[0*4+0],V=w[0*4+1],E=w[0*4+2],G=w[1*4+0],R=w[1*4+1],Y=w[1*4+2],O=w[2*4+0],v=w[2*4+1],Q=w[2*4+2];return D[0]=S,D[1]=G,D[2]=O,D[4]=V,D[5]=R,D[6]=v,D[8]=E,D[9]=Y,D[10]=Q,D}function cn(w,q){const D=q??new a(12),S=w[0*4+0],V=w[0*4+1],E=w[0*4+2],G=w[1*4+0],R=w[1*4+1],Y=w[1*4+2],O=w[2*4+0],v=w[2*4+1],Q=w[2*4+2],M=Q*R-Y*v,P=-Q*G+Y*O,o=v*G-R*O,r=1/(S*M+V*P+E*o);return D[0]=M*r,D[1]=(-Q*V+E*v)*r,D[2]=(Y*V-E*R)*r,D[4]=P*r,D[5]=(Q*S-E*O)*r,D[6]=(-Y*S+E*G)*r,D[8]=o*r,D[9]=(-v*S+V*O)*r,D[10]=(R*S-V*G)*r,D}function Fn(w){const q=w[0],D=w[0*4+1],S=w[0*4+2],V=w[1*4+0],E=w[1*4+1],G=w[1*4+2],R=w[2*4+0],Y=w[2*4+1],O=w[2*4+2];return q*(E*O-Y*G)-V*(D*O-Y*S)+R*(D*G-E*S)}const An=cn;function Sn(w,q,D){const S=D??new a(12),V=w[0],E=w[1],G=w[2],R=w[4],Y=w[5],O=w[6],v=w[8],Q=w[9],M=w[10],P=q[0],o=q[1],r=q[2],f=q[4],d=q[5],B=q[6],n=q[8],c=q[9],t=q[10];return S[0]=V*P+R*o+v*r,S[1]=E*P+Y*o+Q*r,S[2]=G*P+O*o+M*r,S[4]=V*f+R*d+v*B,S[5]=E*f+Y*d+Q*B,S[6]=G*f+O*d+M*B,S[8]=V*n+R*c+v*t,S[9]=E*n+Y*c+Q*t,S[10]=G*n+O*c+M*t,S}const vn=Sn;function xn(w,q,D){const S=D??tn();return w!==S&&(S[0]=w[0],S[1]=w[1],S[2]=w[2],S[4]=w[4],S[5]=w[5],S[6]=w[6]),S[8]=q[0],S[9]=q[1],S[10]=1,S}function hn(w,q){const D=q??x.create();return D[0]=w[8],D[1]=w[9],D}function Un(w,q,D){const S=D??x.create(),V=q*4;return S[0]=w[V+0],S[1]=w[V+1],S}function Pn(w,q,D,S){const V=S===w?w:C(w,S),E=D*4;return V[E+0]=q[0],V[E+1]=q[1],V}function qn(w,q){const D=q??x.create(),S=w[0],V=w[1],E=w[4],G=w[5];return D[0]=Math.sqrt(S*S+V*V),D[1]=Math.sqrt(E*E+G*G),D}function On(w,q){const D=q??new a(12);return D[0]=1,D[1]=0,D[2]=0,D[4]=0,D[5]=1,D[6]=0,D[8]=w[0],D[9]=w[1],D[10]=1,D}function Bn(w,q,D){const S=D??new a(12),V=q[0],E=q[1],G=w[0],R=w[1],Y=w[2],O=w[1*4+0],v=w[1*4+1],Q=w[1*4+2],M=w[2*4+0],P=w[2*4+1],o=w[2*4+2];return w!==S&&(S[0]=G,S[1]=R,S[2]=Y,S[4]=O,S[5]=v,S[6]=Q),S[8]=G*V+O*E+M,S[9]=R*V+v*E+P,S[10]=Y*V+Q*E+o,S}function En(w,q){const D=q??new a(12),S=Math.cos(w),V=Math.sin(w);return D[0]=S,D[1]=V,D[2]=0,D[4]=-V,D[5]=S,D[6]=0,D[8]=0,D[9]=0,D[10]=1,D}function en(w,q,D){const S=D??new a(12),V=w[0*4+0],E=w[0*4+1],G=w[0*4+2],R=w[1*4+0],Y=w[1*4+1],O=w[1*4+2],v=Math.cos(q),Q=Math.sin(q);return S[0]=v*V+Q*R,S[1]=v*E+Q*Y,S[2]=v*G+Q*O,S[4]=v*R-Q*V,S[5]=v*Y-Q*E,S[6]=v*O-Q*G,w!==S&&(S[8]=w[8],S[9]=w[9],S[10]=w[10]),S}function Ln(w,q){const D=q??new a(12);return D[0]=w[0],D[1]=0,D[2]=0,D[4]=0,D[5]=w[1],D[6]=0,D[8]=0,D[9]=0,D[10]=1,D}function H(w,q,D){const S=D??new a(12),V=q[0],E=q[1];return S[0]=V*w[0*4+0],S[1]=V*w[0*4+1],S[2]=V*w[0*4+2],S[4]=E*w[1*4+0],S[5]=E*w[1*4+1],S[6]=E*w[1*4+2],w!==S&&(S[8]=w[8],S[9]=w[9],S[10]=w[10]),S}function J(w,q){const D=q??new a(12);return D[0]=w,D[1]=0,D[2]=0,D[4]=0,D[5]=w,D[6]=0,D[8]=0,D[9]=0,D[10]=1,D}function Z(w,q,D){const S=D??new a(12);return S[0]=q*w[0*4+0],S[1]=q*w[0*4+1],S[2]=q*w[0*4+2],S[4]=q*w[1*4+0],S[5]=q*w[1*4+1],S[6]=q*w[1*4+2],w!==S&&(S[8]=w[8],S[9]=w[9],S[10]=w[10]),S}return{clone:Dn,create:U,set:K,fromMat4:X,fromQuat:j,negate:nn,copy:C,equalsApproximately:gn,equals:yn,identity:tn,transpose:zn,inverse:cn,invert:An,determinant:Fn,mul:vn,multiply:Sn,setTranslation:xn,getTranslation:hn,getAxis:Un,setAxis:Pn,getScaling:qn,translation:On,translate:Bn,rotation:En,rotate:en,scaling:Ln,scale:H,uniformScaling:J,uniformScale:Z}}const bn=new Map;function ft(a){let x=bn.get(a);return x||(x=at(a),bn.set(a,x)),x}function wt(a){function x(s,i,h){const l=new a(3);return s!==void 0&&(l[0]=s,i!==void 0&&(l[1]=i,h!==void 0&&(l[2]=h))),l}const U=x;function K(s,i,h,l){const y=l??new a(3);return y[0]=s,y[1]=i,y[2]=h,y}function X(s,i){const h=i??new a(3);return h[0]=Math.ceil(s[0]),h[1]=Math.ceil(s[1]),h[2]=Math.ceil(s[2]),h}function j(s,i){const h=i??new a(3);return h[0]=Math.floor(s[0]),h[1]=Math.floor(s[1]),h[2]=Math.floor(s[2]),h}function nn(s,i){const h=i??new a(3);return h[0]=Math.round(s[0]),h[1]=Math.round(s[1]),h[2]=Math.round(s[2]),h}function C(s,i=0,h=1,l){const y=l??new a(3);return y[0]=Math.min(h,Math.max(i,s[0])),y[1]=Math.min(h,Math.max(i,s[1])),y[2]=Math.min(h,Math.max(i,s[2])),y}function Dn(s,i,h){const l=h??new a(3);return l[0]=s[0]+i[0],l[1]=s[1]+i[1],l[2]=s[2]+i[2],l}function gn(s,i,h,l){const y=l??new a(3);return y[0]=s[0]+i[0]*h,y[1]=s[1]+i[1]*h,y[2]=s[2]+i[2]*h,y}function yn(s,i){const h=s[0],l=s[1],y=s[2],g=i[0],A=i[1],F=i[2],L=Math.sqrt(h*h+l*l+y*y),T=Math.sqrt(g*g+A*A+F*F),I=L*T,N=I&&En(s,i)/I;return Math.acos(N)}function tn(s,i,h){const l=h??new a(3);return l[0]=s[0]-i[0],l[1]=s[1]-i[1],l[2]=s[2]-i[2],l}const zn=tn;function cn(s,i){return Math.abs(s[0]-i[0])<$&&Math.abs(s[1]-i[1])<$&&Math.abs(s[2]-i[2])<$}function Fn(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]}function An(s,i,h,l){const y=l??new a(3);return y[0]=s[0]+h*(i[0]-s[0]),y[1]=s[1]+h*(i[1]-s[1]),y[2]=s[2]+h*(i[2]-s[2]),y}function Sn(s,i,h,l){const y=l??new a(3);return y[0]=s[0]+h[0]*(i[0]-s[0]),y[1]=s[1]+h[1]*(i[1]-s[1]),y[2]=s[2]+h[2]*(i[2]-s[2]),y}function vn(s,i,h){const l=h??new a(3);return l[0]=Math.max(s[0],i[0]),l[1]=Math.max(s[1],i[1]),l[2]=Math.max(s[2],i[2]),l}function xn(s,i,h){const l=h??new a(3);return l[0]=Math.min(s[0],i[0]),l[1]=Math.min(s[1],i[1]),l[2]=Math.min(s[2],i[2]),l}function hn(s,i,h){const l=h??new a(3);return l[0]=s[0]*i,l[1]=s[1]*i,l[2]=s[2]*i,l}const Un=hn;function Pn(s,i,h){const l=h??new a(3);return l[0]=s[0]/i,l[1]=s[1]/i,l[2]=s[2]/i,l}function qn(s,i){const h=i??new a(3);return h[0]=1/s[0],h[1]=1/s[1],h[2]=1/s[2],h}const On=qn;function Bn(s,i,h){const l=h??new a(3),y=s[2]*i[0]-s[0]*i[2],g=s[0]*i[1]-s[1]*i[0];return l[0]=s[1]*i[2]-s[2]*i[1],l[1]=y,l[2]=g,l}function En(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]}function en(s){const i=s[0],h=s[1],l=s[2];return Math.sqrt(i*i+h*h+l*l)}const Ln=en;function H(s){const i=s[0],h=s[1],l=s[2];return i*i+h*h+l*l}const J=H;function Z(s,i){const h=s[0]-i[0],l=s[1]-i[1],y=s[2]-i[2];return Math.sqrt(h*h+l*l+y*y)}const w=Z;function q(s,i){const h=s[0]-i[0],l=s[1]-i[1],y=s[2]-i[2];return h*h+l*l+y*y}const D=q;function S(s,i){const h=i??new a(3),l=s[0],y=s[1],g=s[2],A=Math.sqrt(l*l+y*y+g*g);return A>1e-5?(h[0]=l/A,h[1]=y/A,h[2]=g/A):(h[0]=0,h[1]=0,h[2]=0),h}function V(s,i){const h=i??new a(3);return h[0]=-s[0],h[1]=-s[1],h[2]=-s[2],h}function E(s,i){const h=i??new a(3);return h[0]=s[0],h[1]=s[1],h[2]=s[2],h}const G=E;function R(s,i,h){const l=h??new a(3);return l[0]=s[0]*i[0],l[1]=s[1]*i[1],l[2]=s[2]*i[2],l}const Y=R;function O(s,i,h){const l=h??new a(3);return l[0]=s[0]/i[0],l[1]=s[1]/i[1],l[2]=s[2]/i[2],l}const v=O;function Q(s=1,i){const h=i??new a(3),l=Math.random()*2*Math.PI,y=Math.random()*2-1,g=Math.sqrt(1-y*y)*s;return h[0]=Math.cos(l)*g,h[1]=Math.sin(l)*g,h[2]=y*s,h}function M(s){const i=s??new a(3);return i[0]=0,i[1]=0,i[2]=0,i}function P(s,i,h){const l=h??new a(3),y=s[0],g=s[1],A=s[2],F=i[3]*y+i[7]*g+i[11]*A+i[15]||1;return l[0]=(i[0]*y+i[4]*g+i[8]*A+i[12])/F,l[1]=(i[1]*y+i[5]*g+i[9]*A+i[13])/F,l[2]=(i[2]*y+i[6]*g+i[10]*A+i[14])/F,l}function o(s,i,h){const l=h??new a(3),y=s[0],g=s[1],A=s[2];return l[0]=y*i[0*4+0]+g*i[1*4+0]+A*i[2*4+0],l[1]=y*i[0*4+1]+g*i[1*4+1]+A*i[2*4+1],l[2]=y*i[0*4+2]+g*i[1*4+2]+A*i[2*4+2],l}function r(s,i,h){const l=h??new a(3),y=s[0],g=s[1],A=s[2];return l[0]=y*i[0]+g*i[4]+A*i[8],l[1]=y*i[1]+g*i[5]+A*i[9],l[2]=y*i[2]+g*i[6]+A*i[10],l}function f(s,i,h){const l=h??new a(3),y=i[0],g=i[1],A=i[2],F=i[3]*2,L=s[0],T=s[1],I=s[2],N=g*I-A*T,W=A*L-y*I,k=y*T-g*L;return l[0]=L+N*F+(g*k-A*W)*2,l[1]=T+W*F+(A*N-y*k)*2,l[2]=I+k*F+(y*W-g*N)*2,l}function d(s,i){const h=i??new a(3);return h[0]=s[12],h[1]=s[13],h[2]=s[14],h}function B(s,i,h){const l=h??new a(3),y=i*4;return l[0]=s[y+0],l[1]=s[y+1],l[2]=s[y+2],l}function n(s,i){const h=i??new a(3),l=s[0],y=s[1],g=s[2],A=s[4],F=s[5],L=s[6],T=s[8],I=s[9],N=s[10];return h[0]=Math.sqrt(l*l+y*y+g*g),h[1]=Math.sqrt(A*A+F*F+L*L),h[2]=Math.sqrt(T*T+I*I+N*N),h}function c(s,i,h,l){const y=l??new a(3),g=[],A=[];return g[0]=s[0]-i[0],g[1]=s[1]-i[1],g[2]=s[2]-i[2],A[0]=g[0],A[1]=g[1]*Math.cos(h)-g[2]*Math.sin(h),A[2]=g[1]*Math.sin(h)+g[2]*Math.cos(h),y[0]=A[0]+i[0],y[1]=A[1]+i[1],y[2]=A[2]+i[2],y}function t(s,i,h,l){const y=l??new a(3),g=[],A=[];return g[0]=s[0]-i[0],g[1]=s[1]-i[1],g[2]=s[2]-i[2],A[0]=g[2]*Math.sin(h)+g[0]*Math.cos(h),A[1]=g[1],A[2]=g[2]*Math.cos(h)-g[0]*Math.sin(h),y[0]=A[0]+i[0],y[1]=A[1]+i[1],y[2]=A[2]+i[2],y}function e(s,i,h,l){const y=l??new a(3),g=[],A=[];return g[0]=s[0]-i[0],g[1]=s[1]-i[1],g[2]=s[2]-i[2],A[0]=g[0]*Math.cos(h)-g[1]*Math.sin(h),A[1]=g[0]*Math.sin(h)+g[1]*Math.cos(h),A[2]=g[2],y[0]=A[0]+i[0],y[1]=A[1]+i[1],y[2]=A[2]+i[2],y}function u(s,i,h){const l=h??new a(3);return S(s,l),hn(l,i,l)}function p(s,i,h){const l=h??new a(3);return en(s)>i?u(s,i,l):E(s,l)}function z(s,i,h){const l=h??new a(3);return An(s,i,.5,l)}return{create:x,fromValues:U,set:K,ceil:X,floor:j,round:nn,clamp:C,add:Dn,addScaled:gn,angle:yn,subtract:tn,sub:zn,equalsApproximately:cn,equals:Fn,lerp:An,lerpV:Sn,max:vn,min:xn,mulScalar:hn,scale:Un,divScalar:Pn,inverse:qn,invert:On,cross:Bn,dot:En,length:en,len:Ln,lengthSq:H,lenSq:J,distance:Z,dist:w,distanceSq:q,distSq:D,normalize:S,negate:V,copy:E,clone:G,multiply:R,mul:Y,divide:O,div:v,random:Q,zero:M,transformMat4:P,transformMat4Upper3x3:o,transformMat3:r,transformQuat:f,getTranslation:d,getAxis:B,getScaling:n,rotateX:c,rotateY:t,rotateZ:e,setLength:u,truncate:p,midpoint:z}}const Cn=new Map;function Qn(a){let x=Cn.get(a);return x||(x=wt(a),Cn.set(a,x)),x}function ht(a){const x=Qn(a);function U(n,c,t,e,u,p,z,s,i,h,l,y,g,A,F,L){const T=new a(16);return n!==void 0&&(T[0]=n,c!==void 0&&(T[1]=c,t!==void 0&&(T[2]=t,e!==void 0&&(T[3]=e,u!==void 0&&(T[4]=u,p!==void 0&&(T[5]=p,z!==void 0&&(T[6]=z,s!==void 0&&(T[7]=s,i!==void 0&&(T[8]=i,h!==void 0&&(T[9]=h,l!==void 0&&(T[10]=l,y!==void 0&&(T[11]=y,g!==void 0&&(T[12]=g,A!==void 0&&(T[13]=A,F!==void 0&&(T[14]=F,L!==void 0&&(T[15]=L)))))))))))))))),T}function K(n,c,t,e,u,p,z,s,i,h,l,y,g,A,F,L,T){const I=T??new a(16);return I[0]=n,I[1]=c,I[2]=t,I[3]=e,I[4]=u,I[5]=p,I[6]=z,I[7]=s,I[8]=i,I[9]=h,I[10]=l,I[11]=y,I[12]=g,I[13]=A,I[14]=F,I[15]=L,I}function X(n,c){const t=c??new a(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=0,t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=0,t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function j(n,c){const t=c??new a(16),e=n[0],u=n[1],p=n[2],z=n[3],s=e+e,i=u+u,h=p+p,l=e*s,y=u*s,g=u*i,A=p*s,F=p*i,L=p*h,T=z*s,I=z*i,N=z*h;return t[0]=1-g-L,t[1]=y+N,t[2]=A-I,t[3]=0,t[4]=y-N,t[5]=1-l-L,t[6]=F+T,t[7]=0,t[8]=A+I,t[9]=F-T,t[10]=1-l-g,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nn(n,c){const t=c??new a(16);return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=-n[7],t[8]=-n[8],t[9]=-n[9],t[10]=-n[10],t[11]=-n[11],t[12]=-n[12],t[13]=-n[13],t[14]=-n[14],t[15]=-n[15],t}function C(n,c){const t=c??new a(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}const Dn=C;function gn(n,c){return Math.abs(n[0]-c[0])<$&&Math.abs(n[1]-c[1])<$&&Math.abs(n[2]-c[2])<$&&Math.abs(n[3]-c[3])<$&&Math.abs(n[4]-c[4])<$&&Math.abs(n[5]-c[5])<$&&Math.abs(n[6]-c[6])<$&&Math.abs(n[7]-c[7])<$&&Math.abs(n[8]-c[8])<$&&Math.abs(n[9]-c[9])<$&&Math.abs(n[10]-c[10])<$&&Math.abs(n[11]-c[11])<$&&Math.abs(n[12]-c[12])<$&&Math.abs(n[13]-c[13])<$&&Math.abs(n[14]-c[14])<$&&Math.abs(n[15]-c[15])<$}function yn(n,c){return n[0]===c[0]&&n[1]===c[1]&&n[2]===c[2]&&n[3]===c[3]&&n[4]===c[4]&&n[5]===c[5]&&n[6]===c[6]&&n[7]===c[7]&&n[8]===c[8]&&n[9]===c[9]&&n[10]===c[10]&&n[11]===c[11]&&n[12]===c[12]&&n[13]===c[13]&&n[14]===c[14]&&n[15]===c[15]}function tn(n){const c=n??new a(16);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function zn(n,c){const t=c??new a(16);if(t===n){let W;return W=n[1],n[1]=n[4],n[4]=W,W=n[2],n[2]=n[8],n[8]=W,W=n[3],n[3]=n[12],n[12]=W,W=n[6],n[6]=n[9],n[9]=W,W=n[7],n[7]=n[13],n[13]=W,W=n[11],n[11]=n[14],n[14]=W,t}const e=n[0*4+0],u=n[0*4+1],p=n[0*4+2],z=n[0*4+3],s=n[1*4+0],i=n[1*4+1],h=n[1*4+2],l=n[1*4+3],y=n[2*4+0],g=n[2*4+1],A=n[2*4+2],F=n[2*4+3],L=n[3*4+0],T=n[3*4+1],I=n[3*4+2],N=n[3*4+3];return t[0]=e,t[1]=s,t[2]=y,t[3]=L,t[4]=u,t[5]=i,t[6]=g,t[7]=T,t[8]=p,t[9]=h,t[10]=A,t[11]=I,t[12]=z,t[13]=l,t[14]=F,t[15]=N,t}function cn(n,c){const t=c??new a(16),e=n[0*4+0],u=n[0*4+1],p=n[0*4+2],z=n[0*4+3],s=n[1*4+0],i=n[1*4+1],h=n[1*4+2],l=n[1*4+3],y=n[2*4+0],g=n[2*4+1],A=n[2*4+2],F=n[2*4+3],L=n[3*4+0],T=n[3*4+1],I=n[3*4+2],N=n[3*4+3],W=A*N,k=I*F,m=h*N,b=I*l,sn=h*F,on=A*l,rn=p*N,un=I*z,an=p*F,fn=A*z,ln=p*l,dn=h*z,pn=y*T,Mn=L*g,Tn=s*T,In=L*i,Vn=s*g,Rn=y*i,$n=e*T,Nn=L*u,Xn=e*g,Zn=y*u,Yn=e*i,Wn=s*u,jn=W*i+b*g+sn*T-(k*i+m*g+on*T),Kn=k*u+rn*g+fn*T-(W*u+un*g+an*T),Jn=m*u+un*i+ln*T-(b*u+rn*i+dn*T),kn=on*u+an*i+dn*g-(sn*u+fn*i+ln*g),wn=1/(e*jn+s*Kn+y*Jn+L*kn);return t[0]=wn*jn,t[1]=wn*Kn,t[2]=wn*Jn,t[3]=wn*kn,t[4]=wn*(k*s+m*y+on*L-(W*s+b*y+sn*L)),t[5]=wn*(W*e+un*y+an*L-(k*e+rn*y+fn*L)),t[6]=wn*(b*e+rn*s+dn*L-(m*e+un*s+ln*L)),t[7]=wn*(sn*e+fn*s+ln*y-(on*e+an*s+dn*y)),t[8]=wn*(pn*l+In*F+Vn*N-(Mn*l+Tn*F+Rn*N)),t[9]=wn*(Mn*z+$n*F+Zn*N-(pn*z+Nn*F+Xn*N)),t[10]=wn*(Tn*z+Nn*l+Yn*N-(In*z+$n*l+Wn*N)),t[11]=wn*(Rn*z+Xn*l+Wn*F-(Vn*z+Zn*l+Yn*F)),t[12]=wn*(Tn*A+Rn*I+Mn*h-(Vn*I+pn*h+In*A)),t[13]=wn*(Xn*I+pn*p+Nn*A-($n*A+Zn*I+Mn*p)),t[14]=wn*($n*h+Wn*I+In*p-(Yn*I+Tn*p+Nn*h)),t[15]=wn*(Yn*A+Vn*p+Zn*h-(Xn*h+Wn*A+Rn*p)),t}function Fn(n){const c=n[0],t=n[0*4+1],e=n[0*4+2],u=n[0*4+3],p=n[1*4+0],z=n[1*4+1],s=n[1*4+2],i=n[1*4+3],h=n[2*4+0],l=n[2*4+1],y=n[2*4+2],g=n[2*4+3],A=n[3*4+0],F=n[3*4+1],L=n[3*4+2],T=n[3*4+3],I=y*T,N=L*g,W=s*T,k=L*i,m=s*g,b=y*i,sn=e*T,on=L*u,rn=e*g,un=y*u,an=e*i,fn=s*u,ln=I*z+k*l+m*F-(N*z+W*l+b*F),dn=N*t+sn*l+un*F-(I*t+on*l+rn*F),pn=W*t+on*z+an*F-(k*t+sn*z+fn*F),Mn=b*t+rn*z+fn*l-(m*t+un*z+an*l);return c*ln+p*dn+h*pn+A*Mn}const An=cn;function Sn(n,c,t){const e=t??new a(16),u=n[0],p=n[1],z=n[2],s=n[3],i=n[4],h=n[5],l=n[6],y=n[7],g=n[8],A=n[9],F=n[10],L=n[11],T=n[12],I=n[13],N=n[14],W=n[15],k=c[0],m=c[1],b=c[2],sn=c[3],on=c[4],rn=c[5],un=c[6],an=c[7],fn=c[8],ln=c[9],dn=c[10],pn=c[11],Mn=c[12],Tn=c[13],In=c[14],Vn=c[15];return e[0]=u*k+i*m+g*b+T*sn,e[1]=p*k+h*m+A*b+I*sn,e[2]=z*k+l*m+F*b+N*sn,e[3]=s*k+y*m+L*b+W*sn,e[4]=u*on+i*rn+g*un+T*an,e[5]=p*on+h*rn+A*un+I*an,e[6]=z*on+l*rn+F*un+N*an,e[7]=s*on+y*rn+L*un+W*an,e[8]=u*fn+i*ln+g*dn+T*pn,e[9]=p*fn+h*ln+A*dn+I*pn,e[10]=z*fn+l*ln+F*dn+N*pn,e[11]=s*fn+y*ln+L*dn+W*pn,e[12]=u*Mn+i*Tn+g*In+T*Vn,e[13]=p*Mn+h*Tn+A*In+I*Vn,e[14]=z*Mn+l*Tn+F*In+N*Vn,e[15]=s*Mn+y*Tn+L*In+W*Vn,e}const vn=Sn;function xn(n,c,t){const e=t??tn();return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11]),e[12]=c[0],e[13]=c[1],e[14]=c[2],e[15]=1,e}function hn(n,c){const t=c??x.create();return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function Un(n,c,t){const e=t??x.create(),u=c*4;return e[0]=n[u+0],e[1]=n[u+1],e[2]=n[u+2],e}function Pn(n,c,t,e){const u=e===n?e:C(n,e),p=t*4;return u[p+0]=c[0],u[p+1]=c[1],u[p+2]=c[2],u}function qn(n,c){const t=c??x.create(),e=n[0],u=n[1],p=n[2],z=n[4],s=n[5],i=n[6],h=n[8],l=n[9],y=n[10];return t[0]=Math.sqrt(e*e+u*u+p*p),t[1]=Math.sqrt(z*z+s*s+i*i),t[2]=Math.sqrt(h*h+l*l+y*y),t}function On(n,c,t,e,u){const p=u??new a(16),z=Math.tan(Math.PI*.5-.5*n);if(p[0]=z/c,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=z,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,Number.isFinite(e)){const s=1/(t-e);p[10]=e*s,p[14]=e*t*s}else p[10]=-1,p[14]=-t;return p}function Bn(n,c,t,e=1/0,u){const p=u??new a(16),z=1/Math.tan(n*.5);if(p[0]=z/c,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=z,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,e===1/0)p[10]=0,p[14]=t;else{const s=1/(e-t);p[10]=t*s,p[14]=e*t*s}return p}function En(n,c,t,e,u,p,z){const s=z??new a(16);return s[0]=2/(c-n),s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/(e-t),s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1/(u-p),s[11]=0,s[12]=(c+n)/(n-c),s[13]=(e+t)/(t-e),s[14]=u/(u-p),s[15]=1,s}function en(n,c,t,e,u,p,z){const s=z??new a(16),i=c-n,h=e-t,l=u-p;return s[0]=2*u/i,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*u/h,s[6]=0,s[7]=0,s[8]=(n+c)/i,s[9]=(e+t)/h,s[10]=p/l,s[11]=-1,s[12]=0,s[13]=0,s[14]=u*p/l,s[15]=0,s}function Ln(n,c,t,e,u,p=1/0,z){const s=z??new a(16),i=c-n,h=e-t;if(s[0]=2*u/i,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*u/h,s[6]=0,s[7]=0,s[8]=(n+c)/i,s[9]=(e+t)/h,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,p===1/0)s[10]=0,s[14]=u;else{const l=1/(p-u);s[10]=u*l,s[14]=p*u*l}return s}const H=x.create(),J=x.create(),Z=x.create();function w(n,c,t,e){const u=e??new a(16);return x.normalize(x.subtract(c,n,Z),Z),x.normalize(x.cross(t,Z,H),H),x.normalize(x.cross(Z,H,J),J),u[0]=H[0],u[1]=H[1],u[2]=H[2],u[3]=0,u[4]=J[0],u[5]=J[1],u[6]=J[2],u[7]=0,u[8]=Z[0],u[9]=Z[1],u[10]=Z[2],u[11]=0,u[12]=n[0],u[13]=n[1],u[14]=n[2],u[15]=1,u}function q(n,c,t,e){const u=e??new a(16);return x.normalize(x.subtract(n,c,Z),Z),x.normalize(x.cross(t,Z,H),H),x.normalize(x.cross(Z,H,J),J),u[0]=H[0],u[1]=H[1],u[2]=H[2],u[3]=0,u[4]=J[0],u[5]=J[1],u[6]=J[2],u[7]=0,u[8]=Z[0],u[9]=Z[1],u[10]=Z[2],u[11]=0,u[12]=n[0],u[13]=n[1],u[14]=n[2],u[15]=1,u}function D(n,c,t,e){const u=e??new a(16);return x.normalize(x.subtract(n,c,Z),Z),x.normalize(x.cross(t,Z,H),H),x.normalize(x.cross(Z,H,J),J),u[0]=H[0],u[1]=J[0],u[2]=Z[0],u[3]=0,u[4]=H[1],u[5]=J[1],u[6]=Z[1],u[7]=0,u[8]=H[2],u[9]=J[2],u[10]=Z[2],u[11]=0,u[12]=-(H[0]*n[0]+H[1]*n[1]+H[2]*n[2]),u[13]=-(J[0]*n[0]+J[1]*n[1]+J[2]*n[2]),u[14]=-(Z[0]*n[0]+Z[1]*n[1]+Z[2]*n[2]),u[15]=1,u}function S(n,c){const t=c??new a(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function V(n,c,t){const e=t??new a(16),u=c[0],p=c[1],z=c[2],s=n[0],i=n[1],h=n[2],l=n[3],y=n[1*4+0],g=n[1*4+1],A=n[1*4+2],F=n[1*4+3],L=n[2*4+0],T=n[2*4+1],I=n[2*4+2],N=n[2*4+3],W=n[3*4+0],k=n[3*4+1],m=n[3*4+2],b=n[3*4+3];return n!==e&&(e[0]=s,e[1]=i,e[2]=h,e[3]=l,e[4]=y,e[5]=g,e[6]=A,e[7]=F,e[8]=L,e[9]=T,e[10]=I,e[11]=N),e[12]=s*u+y*p+L*z+W,e[13]=i*u+g*p+T*z+k,e[14]=h*u+A*p+I*z+m,e[15]=l*u+F*p+N*z+b,e}function E(n,c){const t=c??new a(16),e=Math.cos(n),u=Math.sin(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=u,t[7]=0,t[8]=0,t[9]=-u,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function G(n,c,t){const e=t??new a(16),u=n[4],p=n[5],z=n[6],s=n[7],i=n[8],h=n[9],l=n[10],y=n[11],g=Math.cos(c),A=Math.sin(c);return e[4]=g*u+A*i,e[5]=g*p+A*h,e[6]=g*z+A*l,e[7]=g*s+A*y,e[8]=g*i-A*u,e[9]=g*h-A*p,e[10]=g*l-A*z,e[11]=g*y-A*s,n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function R(n,c){const t=c??new a(16),e=Math.cos(n),u=Math.sin(n);return t[0]=e,t[1]=0,t[2]=-u,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=u,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Y(n,c,t){const e=t??new a(16),u=n[0*4+0],p=n[0*4+1],z=n[0*4+2],s=n[0*4+3],i=n[2*4+0],h=n[2*4+1],l=n[2*4+2],y=n[2*4+3],g=Math.cos(c),A=Math.sin(c);return e[0]=g*u-A*i,e[1]=g*p-A*h,e[2]=g*z-A*l,e[3]=g*s-A*y,e[8]=g*i+A*u,e[9]=g*h+A*p,e[10]=g*l+A*z,e[11]=g*y+A*s,n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function O(n,c){const t=c??new a(16),e=Math.cos(n),u=Math.sin(n);return t[0]=e,t[1]=u,t[2]=0,t[3]=0,t[4]=-u,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function v(n,c,t){const e=t??new a(16),u=n[0*4+0],p=n[0*4+1],z=n[0*4+2],s=n[0*4+3],i=n[1*4+0],h=n[1*4+1],l=n[1*4+2],y=n[1*4+3],g=Math.cos(c),A=Math.sin(c);return e[0]=g*u+A*i,e[1]=g*p+A*h,e[2]=g*z+A*l,e[3]=g*s+A*y,e[4]=g*i-A*u,e[5]=g*h-A*p,e[6]=g*l-A*z,e[7]=g*y-A*s,n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function Q(n,c,t){const e=t??new a(16);let u=n[0],p=n[1],z=n[2];const s=Math.sqrt(u*u+p*p+z*z);u/=s,p/=s,z/=s;const i=u*u,h=p*p,l=z*z,y=Math.cos(c),g=Math.sin(c),A=1-y;return e[0]=i+(1-i)*y,e[1]=u*p*A+z*g,e[2]=u*z*A-p*g,e[3]=0,e[4]=u*p*A-z*g,e[5]=h+(1-h)*y,e[6]=p*z*A+u*g,e[7]=0,e[8]=u*z*A+p*g,e[9]=p*z*A-u*g,e[10]=l+(1-l)*y,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}const M=Q;function P(n,c,t,e){const u=e??new a(16);let p=c[0],z=c[1],s=c[2];const i=Math.sqrt(p*p+z*z+s*s);p/=i,z/=i,s/=i;const h=p*p,l=z*z,y=s*s,g=Math.cos(t),A=Math.sin(t),F=1-g,L=h+(1-h)*g,T=p*z*F+s*A,I=p*s*F-z*A,N=p*z*F-s*A,W=l+(1-l)*g,k=z*s*F+p*A,m=p*s*F+z*A,b=z*s*F-p*A,sn=y+(1-y)*g,on=n[0],rn=n[1],un=n[2],an=n[3],fn=n[4],ln=n[5],dn=n[6],pn=n[7],Mn=n[8],Tn=n[9],In=n[10],Vn=n[11];return u[0]=L*on+T*fn+I*Mn,u[1]=L*rn+T*ln+I*Tn,u[2]=L*un+T*dn+I*In,u[3]=L*an+T*pn+I*Vn,u[4]=N*on+W*fn+k*Mn,u[5]=N*rn+W*ln+k*Tn,u[6]=N*un+W*dn+k*In,u[7]=N*an+W*pn+k*Vn,u[8]=m*on+b*fn+sn*Mn,u[9]=m*rn+b*ln+sn*Tn,u[10]=m*un+b*dn+sn*In,u[11]=m*an+b*pn+sn*Vn,n!==u&&(u[12]=n[12],u[13]=n[13],u[14]=n[14],u[15]=n[15]),u}const o=P;function r(n,c){const t=c??new a(16);return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function f(n,c,t){const e=t??new a(16),u=c[0],p=c[1],z=c[2];return e[0]=u*n[0*4+0],e[1]=u*n[0*4+1],e[2]=u*n[0*4+2],e[3]=u*n[0*4+3],e[4]=p*n[1*4+0],e[5]=p*n[1*4+1],e[6]=p*n[1*4+2],e[7]=p*n[1*4+3],e[8]=z*n[2*4+0],e[9]=z*n[2*4+1],e[10]=z*n[2*4+2],e[11]=z*n[2*4+3],n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function d(n,c){const t=c??new a(16);return t[0]=n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function B(n,c,t){const e=t??new a(16);return e[0]=c*n[0*4+0],e[1]=c*n[0*4+1],e[2]=c*n[0*4+2],e[3]=c*n[0*4+3],e[4]=c*n[1*4+0],e[5]=c*n[1*4+1],e[6]=c*n[1*4+2],e[7]=c*n[1*4+3],e[8]=c*n[2*4+0],e[9]=c*n[2*4+1],e[10]=c*n[2*4+2],e[11]=c*n[2*4+3],n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}return{create:U,set:K,fromMat3:X,fromQuat:j,negate:nn,copy:C,clone:Dn,equalsApproximately:gn,equals:yn,identity:tn,transpose:zn,inverse:cn,determinant:Fn,invert:An,multiply:Sn,mul:vn,setTranslation:xn,getTranslation:hn,getAxis:Un,setAxis:Pn,getScaling:qn,perspective:On,perspectiveReverseZ:Bn,ortho:En,frustum:en,frustumReverseZ:Ln,aim:w,cameraAim:q,lookAt:D,translation:S,translate:V,rotationX:E,rotateX:G,rotationY:R,rotateY:Y,rotationZ:O,rotateZ:v,axisRotation:Q,rotation:M,axisRotate:P,rotate:o,scaling:r,scale:f,uniformScaling:d,uniformScale:B}}const nt=new Map;function lt(a){let x=nt.get(a);return x||(x=ht(a),nt.set(a,x)),x}function dt(a){const x=Qn(a);function U(M,P,o,r){const f=new a(4);return M!==void 0&&(f[0]=M,P!==void 0&&(f[1]=P,o!==void 0&&(f[2]=o,r!==void 0&&(f[3]=r)))),f}const K=U;function X(M,P,o,r,f){const d=f??new a(4);return d[0]=M,d[1]=P,d[2]=o,d[3]=r,d}function j(M,P,o){const r=o??new a(4),f=P*.5,d=Math.sin(f);return r[0]=d*M[0],r[1]=d*M[1],r[2]=d*M[2],r[3]=Math.cos(f),r}function nn(M,P){const o=P??x.create(3),r=Math.acos(M[3])*2,f=Math.sin(r*.5);return f>$?(o[0]=M[0]/f,o[1]=M[1]/f,o[2]=M[2]/f):(o[0]=1,o[1]=0,o[2]=0),{angle:r,axis:o}}function C(M,P){const o=en(M,P);return Math.acos(2*o*o-1)}function Dn(M,P,o){const r=o??new a(4),f=M[0],d=M[1],B=M[2],n=M[3],c=P[0],t=P[1],e=P[2],u=P[3];return r[0]=f*u+n*c+d*e-B*t,r[1]=d*u+n*t+B*c-f*e,r[2]=B*u+n*e+f*t-d*c,r[3]=n*u-f*c-d*t-B*e,r}const gn=Dn;function yn(M,P,o){const r=o??new a(4),f=P*.5,d=M[0],B=M[1],n=M[2],c=M[3],t=Math.sin(f),e=Math.cos(f);return r[0]=d*e+c*t,r[1]=B*e+n*t,r[2]=n*e-B*t,r[3]=c*e-d*t,r}function tn(M,P,o){const r=o??new a(4),f=P*.5,d=M[0],B=M[1],n=M[2],c=M[3],t=Math.sin(f),e=Math.cos(f);return r[0]=d*e-n*t,r[1]=B*e+c*t,r[2]=n*e+d*t,r[3]=c*e-B*t,r}function zn(M,P,o){const r=o??new a(4),f=P*.5,d=M[0],B=M[1],n=M[2],c=M[3],t=Math.sin(f),e=Math.cos(f);return r[0]=d*e+B*t,r[1]=B*e-d*t,r[2]=n*e+c*t,r[3]=c*e-n*t,r}function cn(M,P,o,r){const f=r??new a(4),d=M[0],B=M[1],n=M[2],c=M[3];let t=P[0],e=P[1],u=P[2],p=P[3],z=d*t+B*e+n*u+c*p;z<0&&(z=-z,t=-t,e=-e,u=-u,p=-p);let s,i;if(1-z>$){const h=Math.acos(z),l=Math.sin(h);s=Math.sin((1-o)*h)/l,i=Math.sin(o*h)/l}else s=1-o,i=o;return f[0]=s*d+i*t,f[1]=s*B+i*e,f[2]=s*n+i*u,f[3]=s*c+i*p,f}function Fn(M,P){const o=P??new a(4),r=M[0],f=M[1],d=M[2],B=M[3],n=r*r+f*f+d*d+B*B,c=n?1/n:0;return o[0]=-r*c,o[1]=-f*c,o[2]=-d*c,o[3]=B*c,o}function An(M,P){const o=P??new a(4);return o[0]=-M[0],o[1]=-M[1],o[2]=-M[2],o[3]=M[3],o}function Sn(M,P){const o=P??new a(4),r=M[0]+M[5]+M[10];if(r>0){const f=Math.sqrt(r+1);o[3]=.5*f;const d=.5/f;o[0]=(M[6]-M[9])*d,o[1]=(M[8]-M[2])*d,o[2]=(M[1]-M[4])*d}else{let f=0;M[5]>M[0]&&(f=1),M[10]>M[f*4+f]&&(f=2);const d=(f+1)%3,B=(f+2)%3,n=Math.sqrt(M[f*4+f]-M[d*4+d]-M[B*4+B]+1);o[f]=.5*n;const c=.5/n;o[3]=(M[d*4+B]-M[B*4+d])*c,o[d]=(M[d*4+f]+M[f*4+d])*c,o[B]=(M[B*4+f]+M[f*4+B])*c}return o}function vn(M,P,o,r,f){const d=f??new a(4),B=M*.5,n=P*.5,c=o*.5,t=Math.sin(B),e=Math.cos(B),u=Math.sin(n),p=Math.cos(n),z=Math.sin(c),s=Math.cos(c);switch(r){case"xyz":d[0]=t*p*s+e*u*z,d[1]=e*u*s-t*p*z,d[2]=e*p*z+t*u*s,d[3]=e*p*s-t*u*z;break;case"xzy":d[0]=t*p*s-e*u*z,d[1]=e*u*s-t*p*z,d[2]=e*p*z+t*u*s,d[3]=e*p*s+t*u*z;break;case"yxz":d[0]=t*p*s+e*u*z,d[1]=e*u*s-t*p*z,d[2]=e*p*z-t*u*s,d[3]=e*p*s+t*u*z;break;case"yzx":d[0]=t*p*s+e*u*z,d[1]=e*u*s+t*p*z,d[2]=e*p*z-t*u*s,d[3]=e*p*s-t*u*z;break;case"zxy":d[0]=t*p*s-e*u*z,d[1]=e*u*s+t*p*z,d[2]=e*p*z+t*u*s,d[3]=e*p*s-t*u*z;break;case"zyx":d[0]=t*p*s-e*u*z,d[1]=e*u*s+t*p*z,d[2]=e*p*z-t*u*s,d[3]=e*p*s+t*u*z;break;default:throw new Error(`Unknown rotation order: ${r}`)}return d}function xn(M,P){const o=P??new a(4);return o[0]=M[0],o[1]=M[1],o[2]=M[2],o[3]=M[3],o}const hn=xn;function Un(M,P,o){const r=o??new a(4);return r[0]=M[0]+P[0],r[1]=M[1]+P[1],r[2]=M[2]+P[2],r[3]=M[3]+P[3],r}function Pn(M,P,o){const r=o??new a(4);return r[0]=M[0]-P[0],r[1]=M[1]-P[1],r[2]=M[2]-P[2],r[3]=M[3]-P[3],r}const qn=Pn;function On(M,P,o){const r=o??new a(4);return r[0]=M[0]*P,r[1]=M[1]*P,r[2]=M[2]*P,r[3]=M[3]*P,r}const Bn=On;function En(M,P,o){const r=o??new a(4);return r[0]=M[0]/P,r[1]=M[1]/P,r[2]=M[2]/P,r[3]=M[3]/P,r}function en(M,P){return M[0]*P[0]+M[1]*P[1]+M[2]*P[2]+M[3]*P[3]}function Ln(M,P,o,r){const f=r??new a(4);return f[0]=M[0]+o*(P[0]-M[0]),f[1]=M[1]+o*(P[1]-M[1]),f[2]=M[2]+o*(P[2]-M[2]),f[3]=M[3]+o*(P[3]-M[3]),f}function H(M){const P=M[0],o=M[1],r=M[2],f=M[3];return Math.sqrt(P*P+o*o+r*r+f*f)}const J=H;function Z(M){const P=M[0],o=M[1],r=M[2],f=M[3];return P*P+o*o+r*r+f*f}const w=Z;function q(M,P){const o=P??new a(4),r=M[0],f=M[1],d=M[2],B=M[3],n=Math.sqrt(r*r+f*f+d*d+B*B);return n>1e-5?(o[0]=r/n,o[1]=f/n,o[2]=d/n,o[3]=B/n):(o[0]=0,o[1]=0,o[2]=0,o[3]=0),o}function D(M,P){return Math.abs(M[0]-P[0])<$&&Math.abs(M[1]-P[1])<$&&Math.abs(M[2]-P[2])<$&&Math.abs(M[3]-P[3])<$}function S(M,P){return M[0]===P[0]&&M[1]===P[1]&&M[2]===P[2]&&M[3]===P[3]}function V(M){const P=M??new a(4);return P[0]=0,P[1]=0,P[2]=0,P[3]=1,P}const E=x.create(),G=x.create(),R=x.create();function Y(M,P,o){const r=o??new a(4),f=x.dot(M,P);return f<-.999999?(x.cross(G,M,E),x.len(E)<1e-6&&x.cross(R,M,E),x.normalize(E,E),j(E,Math.PI,r),r):f>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(x.cross(M,P,E),r[0]=E[0],r[1]=E[1],r[2]=E[2],r[3]=1+f,q(r,r))}const O=new a(4),v=new a(4);function Q(M,P,o,r,f,d){const B=d??new a(4);return cn(M,r,f,O),cn(P,o,f,v),cn(O,v,2*f*(1-f),B),B}return{create:U,fromValues:K,set:X,fromAxisAngle:j,toAxisAngle:nn,angle:C,multiply:Dn,mul:gn,rotateX:yn,rotateY:tn,rotateZ:zn,slerp:cn,inverse:Fn,conjugate:An,fromMat:Sn,fromEuler:vn,copy:xn,clone:hn,add:Un,subtract:Pn,sub:qn,mulScalar:On,scale:Bn,divScalar:En,dot:en,lerp:Ln,length:H,len:J,lengthSq:Z,lenSq:w,normalize:q,equalsApproximately:D,equals:S,identity:V,rotationTo:Y,sqlerp:Q}}const tt=new Map;function pt(a){let x=tt.get(a);return x||(x=dt(a),tt.set(a,x)),x}function Mt(a){function x(o,r,f,d){const B=new a(4);return o!==void 0&&(B[0]=o,r!==void 0&&(B[1]=r,f!==void 0&&(B[2]=f,d!==void 0&&(B[3]=d)))),B}const U=x;function K(o,r,f,d,B){const n=B??new a(4);return n[0]=o,n[1]=r,n[2]=f,n[3]=d,n}function X(o,r){const f=r??new a(4);return f[0]=Math.ceil(o[0]),f[1]=Math.ceil(o[1]),f[2]=Math.ceil(o[2]),f[3]=Math.ceil(o[3]),f}function j(o,r){const f=r??new a(4);return f[0]=Math.floor(o[0]),f[1]=Math.floor(o[1]),f[2]=Math.floor(o[2]),f[3]=Math.floor(o[3]),f}function nn(o,r){const f=r??new a(4);return f[0]=Math.round(o[0]),f[1]=Math.round(o[1]),f[2]=Math.round(o[2]),f[3]=Math.round(o[3]),f}function C(o,r=0,f=1,d){const B=d??new a(4);return B[0]=Math.min(f,Math.max(r,o[0])),B[1]=Math.min(f,Math.max(r,o[1])),B[2]=Math.min(f,Math.max(r,o[2])),B[3]=Math.min(f,Math.max(r,o[3])),B}function Dn(o,r,f){const d=f??new a(4);return d[0]=o[0]+r[0],d[1]=o[1]+r[1],d[2]=o[2]+r[2],d[3]=o[3]+r[3],d}function gn(o,r,f,d){const B=d??new a(4);return B[0]=o[0]+r[0]*f,B[1]=o[1]+r[1]*f,B[2]=o[2]+r[2]*f,B[3]=o[3]+r[3]*f,B}function yn(o,r,f){const d=f??new a(4);return d[0]=o[0]-r[0],d[1]=o[1]-r[1],d[2]=o[2]-r[2],d[3]=o[3]-r[3],d}const tn=yn;function zn(o,r){return Math.abs(o[0]-r[0])<$&&Math.abs(o[1]-r[1])<$&&Math.abs(o[2]-r[2])<$&&Math.abs(o[3]-r[3])<$}function cn(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]}function Fn(o,r,f,d){const B=d??new a(4);return B[0]=o[0]+f*(r[0]-o[0]),B[1]=o[1]+f*(r[1]-o[1]),B[2]=o[2]+f*(r[2]-o[2]),B[3]=o[3]+f*(r[3]-o[3]),B}function An(o,r,f,d){const B=d??new a(4);return B[0]=o[0]+f[0]*(r[0]-o[0]),B[1]=o[1]+f[1]*(r[1]-o[1]),B[2]=o[2]+f[2]*(r[2]-o[2]),B[3]=o[3]+f[3]*(r[3]-o[3]),B}function Sn(o,r,f){const d=f??new a(4);return d[0]=Math.max(o[0],r[0]),d[1]=Math.max(o[1],r[1]),d[2]=Math.max(o[2],r[2]),d[3]=Math.max(o[3],r[3]),d}function vn(o,r,f){const d=f??new a(4);return d[0]=Math.min(o[0],r[0]),d[1]=Math.min(o[1],r[1]),d[2]=Math.min(o[2],r[2]),d[3]=Math.min(o[3],r[3]),d}function xn(o,r,f){const d=f??new a(4);return d[0]=o[0]*r,d[1]=o[1]*r,d[2]=o[2]*r,d[3]=o[3]*r,d}const hn=xn;function Un(o,r,f){const d=f??new a(4);return d[0]=o[0]/r,d[1]=o[1]/r,d[2]=o[2]/r,d[3]=o[3]/r,d}function Pn(o,r){const f=r??new a(4);return f[0]=1/o[0],f[1]=1/o[1],f[2]=1/o[2],f[3]=1/o[3],f}const qn=Pn;function On(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]+o[3]*r[3]}function Bn(o){const r=o[0],f=o[1],d=o[2],B=o[3];return Math.sqrt(r*r+f*f+d*d+B*B)}const En=Bn;function en(o){const r=o[0],f=o[1],d=o[2],B=o[3];return r*r+f*f+d*d+B*B}const Ln=en;function H(o,r){const f=o[0]-r[0],d=o[1]-r[1],B=o[2]-r[2],n=o[3]-r[3];return Math.sqrt(f*f+d*d+B*B+n*n)}const J=H;function Z(o,r){const f=o[0]-r[0],d=o[1]-r[1],B=o[2]-r[2],n=o[3]-r[3];return f*f+d*d+B*B+n*n}const w=Z;function q(o,r){const f=r??new a(4),d=o[0],B=o[1],n=o[2],c=o[3],t=Math.sqrt(d*d+B*B+n*n+c*c);return t>1e-5?(f[0]=d/t,f[1]=B/t,f[2]=n/t,f[3]=c/t):(f[0]=0,f[1]=0,f[2]=0,f[3]=0),f}function D(o,r){const f=r??new a(4);return f[0]=-o[0],f[1]=-o[1],f[2]=-o[2],f[3]=-o[3],f}function S(o,r){const f=r??new a(4);return f[0]=o[0],f[1]=o[1],f[2]=o[2],f[3]=o[3],f}const V=S;function E(o,r,f){const d=f??new a(4);return d[0]=o[0]*r[0],d[1]=o[1]*r[1],d[2]=o[2]*r[2],d[3]=o[3]*r[3],d}const G=E;function R(o,r,f){const d=f??new a(4);return d[0]=o[0]/r[0],d[1]=o[1]/r[1],d[2]=o[2]/r[2],d[3]=o[3]/r[3],d}const Y=R;function O(o){const r=o??new a(4);return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r}function v(o,r,f){const d=f??new a(4),B=o[0],n=o[1],c=o[2],t=o[3];return d[0]=r[0]*B+r[4]*n+r[8]*c+r[12]*t,d[1]=r[1]*B+r[5]*n+r[9]*c+r[13]*t,d[2]=r[2]*B+r[6]*n+r[10]*c+r[14]*t,d[3]=r[3]*B+r[7]*n+r[11]*c+r[15]*t,d}function Q(o,r,f){const d=f??new a(4);return q(o,d),xn(d,r,d)}function M(o,r,f){const d=f??new a(4);return Bn(o)>r?Q(o,r,d):S(o,d)}function P(o,r,f){const d=f??new a(4);return Fn(o,r,.5,d)}return{create:x,fromValues:U,set:K,ceil:X,floor:j,round:nn,clamp:C,add:Dn,addScaled:gn,subtract:yn,sub:tn,equalsApproximately:zn,equals:cn,lerp:Fn,lerpV:An,max:Sn,min:vn,mulScalar:xn,scale:hn,divScalar:Un,inverse:Pn,invert:qn,dot:On,length:Bn,len:En,lengthSq:en,lenSq:Ln,distance:H,dist:J,distanceSq:Z,distSq:w,normalize:q,negate:D,copy:S,clone:V,multiply:E,mul:G,divide:R,div:Y,zero:O,transformMat4:v,setLength:Q,truncate:M,midpoint:P}}const et=new Map;function Dt(a){let x=et.get(a);return x||(x=Mt(a),et.set(a,x)),x}function _n(a,x,U,K,X,j){return{mat4:lt(a),mat3:ft(x),quat:pt(U),vec2:st(K),vec3:Qn(X),vec4:Dt(j)}}const{mat4:Gn,mat3:qt,quat:Bt,vec2:Et,vec3:Hn,vec4:Tt}=_n(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array);_n(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array);_n(it,Array,Array,Array,Array,Array);const yt=new Float32Array([1,-1,0,-1,-1,0,0,1,0]),xt=new Float32Array([1,0,0,1,0,1,0,1,0,0,1,1]),gt=new Uint16Array([0,1,2,0]);class zt{constructor(x){_(this,"canvas");_(this,"device");_(this,"queue");_(this,"presentationContext");_(this,"presentationSize");_(this,"presentationFormat");_(this,"positionBuffer");_(this,"colorBuffer");_(this,"indexBuffer");_(this,"uniformBuffer");_(this,"vertexModule");_(this,"fragmentModule");_(this,"renderTarget");_(this,"renderTargetView");_(this,"depthTarget");_(this,"depthTargetView");_(this,"renderPipeline");_(this,"commandEncoder");_(this,"passEncoder");_(this,"modelMatrix",Gn.identity());_(this,"viewMatrix",Gn.identity());_(this,"perspectiveMatrix",Gn.identity());_(this,"eye",Hn.create(0,0,5));_(this,"zNear",.1);_(this,"zFar",1e3);_(this,"sampleCount",4);_(this,"uniformBindGroup");_(this,"onMouseWheel",x=>{let U=this.eye[2]+=x.deltaY*.01;U=Math.max(this.zNear,Math.min(this.zFar,U)),this.eye[2]=U});_(this,"render",()=>{const x=.5*Math.PI/180;Gn.rotateZ(this.modelMatrix,x,this.modelMatrix),this.updateUniformBuffer(),this.encodeCommands(),requestAnimationFrame(this.render)});this.canvas=x,this.updateViewMatrix(),this.updatePerspectiveMatrix()}updatePerspectiveMatrix(){const x=this.canvas.width/this.canvas.height,U=45*Math.PI/180;this.perspectiveMatrix=Gn.perspective(U,x,this.zNear,this.zFar)}updateViewMatrix(){const x=Hn.create(0,0,0),U=Hn.create(0,1,0);this.viewMatrix=Gn.lookAt(this.eye,x,U)}resize(x,U){(x!==this.presentationSize.width||U!==this.presentationSize.height)&&(this.canvas.width=x,this.canvas.height=U,this.presentationSize={width:x,height:U,depthOrArrayLayers:1},this.updatePerspectiveMatrix(),this.resizeSwapchain())}async initialize(){const x=navigator.gpu;if(!x)return console.error("No WebGPU support navigator.gpu not available!"),!1;const U=await x.requestAdapter();return console.log(U.limits),this.device=await U.requestDevice(),this.queue=this.device.queue,this.canvas.style.display="block",this.canvas.addEventListener("wheel",this.onMouseWheel),this.presentationSize={width:this.canvas.width,height:this.canvas.height,depthOrArrayLayers:1},this.presentationContext=this.canvas.getContext("webgpu"),this.presentationFormat=x.getPreferredCanvasFormat(),this.presentationContext.configure({device:this.device,format:this.presentationFormat,alphaMode:"opaque"}),new ResizeObserver(X=>{Array.isArray(X)&&this.resize(X[0].contentRect.width*window.devicePixelRatio,X[0].contentRect.height*window.devicePixelRatio)}).observe(this.canvas),!0}createBuffer(x,U){try{const K=this.device.createBuffer({mappedAtCreation:!0,size:x.byteLength,usage:U}),X=K.getMappedRange();return(x instanceof Float32Array?new Float32Array(X):new Uint16Array(X)).set(x),K.unmap(),K}catch(K){console.error(K)}}createUBOArray(){const x=new Float32Array(48);return x.set(this.modelMatrix),x.set(this.viewMatrix,16),x.set(this.perspectiveMatrix,32),x}updateUniformBuffer(){this.updateViewMatrix();const x=this.createUBOArray();this.queue.writeBuffer(this.uniformBuffer,0,x.buffer)}async loadShader(x){const U=await fetch(x);return this.device.createShaderModule({code:await U.text()})}resizeSwapchain(){this.renderTarget!==void 0&&(this.renderTarget.destroy(),this.depthTarget.destroy()),this.renderTarget=this.device.createTexture({size:this.presentationSize,sampleCount:this.sampleCount,format:this.presentationFormat,usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.renderTargetView=this.renderTarget.createView(),this.depthTarget=this.device.createTexture({size:this.presentationSize,sampleCount:this.sampleCount,format:"depth24plus-stencil8",usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.depthTargetView=this.depthTarget.createView()}encodeCommands(){const x={view:this.presentationContext.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"};this.sampleCount>1&&(x.view=this.renderTargetView,x.resolveTarget=this.presentationContext.getCurrentTexture().createView());const U={view:this.depthTargetView,depthLoadOp:"clear",depthClearValue:1,depthStoreOp:"store",stencilLoadOp:"clear",stencilClearValue:0,stencilStoreOp:"store"},K={colorAttachments:[x],depthStencilAttachment:U};this.commandEncoder=this.device.createCommandEncoder(),this.passEncoder=this.commandEncoder.beginRenderPass(K),this.passEncoder.setPipeline(this.renderPipeline),this.passEncoder.setBindGroup(0,this.uniformBindGroup),this.passEncoder.setViewport(0,0,this.canvas.width,this.canvas.height,0,1),this.passEncoder.setScissorRect(0,0,this.canvas.width,this.canvas.height),this.passEncoder.setVertexBuffer(0,this.positionBuffer),this.passEncoder.setVertexBuffer(1,this.colorBuffer),this.passEncoder.setIndexBuffer(this.indexBuffer,"uint16"),this.passEncoder.drawIndexed(3,1,0,0,0),this.passEncoder.end(),this.queue.submit([this.commandEncoder.finish()])}async initializeResources(){this.positionBuffer=this.createBuffer(yt,GPUBufferUsage.VERTEX),this.colorBuffer=this.createBuffer(xt,GPUBufferUsage.VERTEX),this.indexBuffer=this.createBuffer(gt,GPUBufferUsage.INDEX);const x=this.createUBOArray();this.uniformBuffer=this.createBuffer(x,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),this.vertexModule=await this.loadShader("./shaders/basic.vert.wgsl"),this.fragmentModule=await this.loadShader("./shaders/basic.frag.wgsl");const U={shaderLocation:0,offset:0,format:"float32x3"},K={shaderLocation:1,offset:0,format:"float32x4"},X={attributes:[U],arrayStride:4*3,stepMode:"vertex"},j={attributes:[K],arrayStride:4*4,stepMode:"vertex"},nn={depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus-stencil8"},C=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}}]});this.uniformBindGroup=this.device.createBindGroup({layout:C,entries:[{binding:0,resource:{buffer:this.uniformBuffer}}]});const Dn=this.device.createPipelineLayout({bindGroupLayouts:[C]}),gn={module:this.vertexModule,entryPoint:"main",buffers:[X,j]},yn={format:"bgra8unorm",blend:{alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}},writeMask:GPUColorWrite.ALL},tn={module:this.fragmentModule,entryPoint:"main",targets:[yn]},zn={layout:Dn,vertex:gn,fragment:tn,primitive:{topology:"triangle-list",frontFace:"cw",cullMode:"none"},depthStencil:nn,multisample:{count:this.sampleCount}};this.renderPipeline=this.device.createRenderPipeline(zn)}async start(){if(await this.initialize())this.resizeSwapchain(),await this.initializeResources(),this.render();else{const x=document.getElementById("error");x.style.display="block"}}}const At=document.getElementById("webgpu_canvas"),St=new zt(At);St.start();
